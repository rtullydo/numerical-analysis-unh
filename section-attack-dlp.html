<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-11-21T15:45:43-05:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Attacking the discrete log problem</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.12/pretext.js"></script><script src="https://pretextbook.org/js/0.12/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/toc.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/setcolors.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.12;
</script>
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\DeclareMathOperator{\RE}{Re}
\DeclareMathOperator{\IM}{Im}
\DeclareMathOperator{\ess}{ess}
\DeclareMathOperator{\intr}{int}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator\re{\mathrm {Re~}}
\DeclareMathOperator\im{\mathrm {Im~}}
\newcommand\dd{\mathrm d}
\newcommand{\eps}{\varepsilon}
\newcommand{\To}{\longrightarrow}
\newcommand{\hilbert}{\mathcal{H}}
\newcommand{\s}{\mathcal{S}_2}
\newcommand{\A}{\mathcal{A}}
\newcommand\h{\mathcal{H}}
\newcommand{\J}{\mathcal{J}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathcal{N}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\W}{\mathcal{W}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\D}{\mathbb{D}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\BOP}{\mathbf{B}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\BH}{\mathbf{B}(\mathcal{H})}
\newcommand{\KH}{\mathcal{K}(\mathcal{H})}
\newcommand{\pick}{\mathcal{P}_2}
\newcommand{\schur}{\mathcal{S}_2}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Complex}{\mathbb{C}}
\newcommand{\Field}{\mathbb{F}}
\newcommand{\RPlus}{\Real^{+}}
\newcommand{\Polar}{\mathcal{P}_{\s}}
\newcommand{\Poly}{\mathcal{P}(E)}
\newcommand{\EssD}{\mathcal{D}}
\newcommand{\Lop}{\mathcal{L}}
\newcommand{\cc}[1]{\overline{#1}}
\newcommand{\abs}[1]{\left\vert#1\right\vert}
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\seq}[1]{\left\lt#1\right&gt;}
\newcommand{\norm}[1]{\left\Vert#1\right\Vert}
\newcommand{\essnorm}[1]{\norm{#1}_{\ess}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\ran}[1]{\operatorname{ran}#1}
\newcommand{\nt}{\stackrel{\mathrm {nt}}{\to}}
\newcommand{\pnt}{\xrightarrow{pnt}}
\newcommand{\ip}[2]{\left\langle #1, #2 \right\rangle}
\newcommand{\ad}{^\ast}
\newcommand{\inv}{^{-1}}
\newcommand{\adinv}{^{\ast -1}}
\newcommand{\invad}{^{-1 \ast}}
\newcommand\Pick{\mathcal P}
\newcommand\Ha{\mathbb{H}}
\newcommand{\HH}{\Ha\times\Ha}
\newcommand\Htau{\mathbb{H}(\tau)}
\newcommand{\vp}{\varphi}
\newcommand{\ph}{\varphi}
\newcommand\al{\alpha}
\newcommand\ga{\gamma}
\newcommand\de{\delta}
\newcommand\ep{\varepsilon}
\newcommand\la{\lambda}
\newcommand\up{\upsilon}
\newcommand\si{\sigma}
\newcommand\beq{\begin{equation}}
\newcommand\ds{\displaystyle}
\newcommand\eeq{\end{equation}}
\newcommand\df{\stackrel{\rm def}{=}}
\newcommand\ii{\mathrm i}
\newcommand{\vectwo}[2]
{
   \begin{pmatrix} #1 \\ #2 \end{pmatrix}
}
\newcommand{\vecthree}[3]
{
   \begin{pmatrix} #1 \\ #2 \\ #3 \end{pmatrix}
}
\newcommand\blue{\color{blue}}
\newcommand\black{\color{black}}
\newcommand\red{\color{red}}
\newcommand\nn{\nonumber}
\newcommand\bbm{\begin{bmatrix}}
\newcommand\ebm{\end{bmatrix}}
\newcommand\bpm{\begin{pmatrix}}
\newcommand\epm{\end{pmatrix}}
\numberwithin{equation}{section}
\newcommand\nin{\noindent}
\newcommand{\nCr}[2]{\,_{#1}C_{#2}} 
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="cryptography.html"><span class="title">Mathematical Cryptography</span></a></h1>
<p class="byline">Ryan Tully-Doyle</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="section-groups.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="chapter-groups.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="section-chinese.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="section-groups.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="chapter-groups.html" title="Up">Up</a><a class="next-button button toolbar-item" href="section-chinese.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link"><a href="frontmatter-1.html" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a></li>
<li class="link">
<a href="chapter-intro.html" data-scroll="chapter-intro"><span class="codenumber">1</span> <span class="title">Preliminaries</span></a><ul>
<li><a href="foreward.html" data-scroll="foreward">The course</a></li>
<li><a href="motivation.html" data-scroll="motivation">Why “mathematical” cryptography?</a></li>
<li><a href="shift.html" data-scroll="shift">A simple example: the shift cipher</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-numbertheory.html" data-scroll="chapter-numbertheory"><span class="codenumber">2</span> <span class="title">Number theory</span></a><ul>
<li><a href="divisibility.html" data-scroll="divisibility">Integers and divisibility</a></li>
<li><a href="section-euclidean.html" data-scroll="section-euclidean">Common divisors and the Euclidean algorithm</a></li>
<li><a href="section-modular.html" data-scroll="section-modular">Modular arithmetic and the ring of integers modulo \(n\)</a></li>
<li><a href="section-fastpower.html" data-scroll="section-fastpower">The fast powering algorithm</a></li>
<li><a href="section-finite-fields.html" data-scroll="section-finite-fields">Finite fields</a></li>
<li><a href="section-fermat.html" data-scroll="section-fermat">Fermat's little theorem and computing inverses</a></li>
<li><a href="section-ch2-conclusion.html" data-scroll="section-ch2-conclusion">Conclusion</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-groups.html" data-scroll="chapter-groups"><span class="codenumber">3</span> <span class="title">Group based methods</span></a><ul>
<li><a href="section-naive.html" data-scroll="section-naive">A naïve cryptosystem and some related questions</a></li>
<li><a href="section-discretelog.html" data-scroll="section-discretelog">Discrete logarithms</a></li>
<li><a href="section-dh.html" data-scroll="section-dh">Diffie-Hellman key exchange</a></li>
<li><a href="section-elgamal.html" data-scroll="section-elgamal">The Elgamal cryptosystem</a></li>
<li><a href="section-groups.html" data-scroll="section-groups">Groups</a></li>
<li><a href="section-attack-dlp.html" data-scroll="section-attack-dlp" class="active">Attacking the discrete log problem</a></li>
<li><a href="section-chinese.html" data-scroll="section-chinese">The Chinese Remainder theorem and Pohlig-Hellman*</a></li>
<li><a href="section-homomorphism.html" data-scroll="section-homomorphism">Homomorphisms and the lunchtime attack</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-elliptic-curves.html" data-scroll="chapter-elliptic-curves"><span class="codenumber">4</span> <span class="title">Elliptic curves and applications</span></a><ul>
<li><a href="section-ec-intro.html" data-scroll="section-ec-intro">Introduction to elliptic curves</a></li>
<li><a href="section-elliptic-addition.html" data-scroll="section-elliptic-addition">Elliptic addition on \(E\text{.}\)</a></li>
<li><a href="section-ec-finite-fields.html" data-scroll="section-ec-finite-fields">Elliptic curves over finite fields</a></li>
<li><a href="section-ecdlp.html" data-scroll="section-ecdlp">Discrete logs and the ECDLP</a></li>
<li><a href="section-ec-elgamal.html" data-scroll="section-ec-elgamal">Elliptic curve Diffie-Hellman key exchange and El Gamal</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-digital-signatures.html" data-scroll="chapter-digital-signatures"><span class="codenumber">5</span> <span class="title">Digital signatures</span></a><ul>
<li><a href="section-dsa-intro.html" data-scroll="section-dsa-intro">Introduction to digital signatures</a></li>
<li><a href="section-elgamal-ds.html" data-scroll="section-elgamal-ds">Elgamal digital signatures</a></li>
<li><a href="section-subgroups.html" data-scroll="section-subgroups">Subgroups and cyclic subgroups</a></li>
<li><a href="section-dsa-ecdsa.html" data-scroll="section-dsa-ecdsa">DSA and Elliptic Curve DSA</a></li>
<li><a href="section-bitcoin.html" data-scroll="section-bitcoin">Bitcoin - an application of ECDSA*</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-probability.html" data-scroll="chapter-probability"><span class="codenumber">6</span> <span class="title">Probability and non-deterministic methods</span></a><ul>
<li><a href="section-counting.html" data-scroll="section-counting">Counting*</a></li>
<li><a href="section-perm-comb.html" data-scroll="section-perm-comb">Permutations and combinations*</a></li>
<li><a href="section-prime-testing.html" data-scroll="section-prime-testing">Primality testing</a></li>
<li><a href="section-pollard-concrete.html" data-scroll="section-pollard-concrete">Pollard's \(\rho\) method</a></li>
</ul>
</li>
<li class="link"><a href="backmatter-1.html" data-scroll="backmatter-1"><span class="title">Back Matter</span></a></li>
<li class="link"><a href="code.html" data-scroll="code"><span class="codenumber">A</span> <span class="title">Code repository</span></a></li>
<li class="link">
<a href="chapter-7.html" data-scroll="chapter-7"><span class="codenumber">7</span> <span class="title">Exercises</span></a><ul>
<li><a href="exercises-21.html" data-scroll="exercises-21">Set 1</a></li>
<li><a href="exercises-22.html" data-scroll="exercises-22">Set 2</a></li>
<li><a href="exercises-23.html" data-scroll="exercises-23">Set 3</a></li>
<li><a href="exercises-24.html" data-scroll="exercises-24">Set 4</a></li>
</ul>
</li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="section-attack-dlp"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">3.6</span> <span class="title">Attacking the discrete log problem</span>
</h2>
<a href="section-attack-dlp.html" class="permalink">¶</a><p id="p-111">Part of understanding cryptography is understanding how attacks on cryptographic systems are performed. Since this is a mathematical cryptography course, we'll focus on mathematical attacks. Diffie-Hellman key exchange and the related Elgamal encryption system rely on the difficulty of the DLP for security. In this section, we'll look at some of the methods used to reduce the difficulty of attacking the DLP from the brute force case.</p>
<p id="p-112">To make our study of difficulty precise, we need a way to quantify how hard a problem is to solve. In the cryptographic setting, difficulty will always scale in some way with the size of the numbers being used to construct a system, and we need a representation for how that scaling affects methods of solution. We'll use the notion of the <dfn class="terminology">order</dfn> of a function, usually called “big oh notation”, which is used to describe relationships depending on large quanitites. The information contained in a big O relationship is <em class="emphasis">asymptotic</em> - that is, it tells us what happens as values of the inputs get large, but shouldn't be expected to have any bearing on the relationship of quantities in small cases.</p>
<article class="definition-like" id="definition-14"><h6 class="heading">
<span class="type">Definition</span> <span class="codenumber">3.6.1</span>.</h6>Let \(f(x)\) and \(g(x)\) be positive functions. Then we say that \(f = \mathcal O(g(x))\) if there exist positive constants \(c, C\) so that<div class="displaymath">
\begin{equation*}
f(x) \leq cg(x) \text{ for all } x \geq C.
\end{equation*}
</div>That is, \(f\) is eventually always smaller than a constant multiple of \(g\text{.}\)</article><p id="p-113">The concept of order relationships has usage all over mathematics and computer science. For our purposes, we are going to relate the size of our inputs to the number of steps required to perform some algorithmic process. We will compare input size <em class="emphasis">in bits</em> to the number of steps.</p>
<ol class="decimal">
<li id="li-93">
<p id="p-114">Polynomial time: input \(\mathcal O(k)\text{,}\) output \(\mathcal O(k^A)\) for some \(A\text{.}\) Different values of \(A\) give different running times:</p>
<ol class="lower-alpha">
<li id="li-94">\(A = 1:\) linear time</li>
<li id="li-95">\(A = 2:\) quadratic time</li>
<li id="li-96">\(\vdots\)</li>
</ol>
<p>Polynomial time computations are “easy”.</p>
</li>
<li id="li-97">Exponential time: input \(\mathcal O(k)\text{,}\) output \(\mathcal O(e^{ck})\) for some constant \(c\text{.}\) Exponential time computations are “slow”.</li>
<li id="li-98">Subexponential time: somewhere in between. Example: output \(\mathcal O(e^{c\sqrt{ k \log k}})\)</li>
</ol>
<p id="p-115">The preference in cryptography is for methods that take exponential time to brute force. So how hard is the discrete logarithm problem in \(\F_p\ad\text{?}\)</p>
<article class="theorem-like" id="algorithm-5"><h6 class="heading">
<span class="type">Algorithm</span> <span class="codenumber">3.6.2</span>. <span class="title">Naive.</span>
</h6>\(p\)\(2^k\)\(2^{k+1}\text{.}\)\(\F_p\ad\)\(p, g, h\text{,}\)\(3k\)\(\mathcal O(k)\)\(x\)<div class="displaymath">
\begin{equation*}
g^x \equiv h \bmod p,
\end{equation*}
</div>\(x\)\(1, \ldots, p-1\text{.}\)\(\mathcal O(k)\)\(\mathcal O(p) = \mathcal O(2^k)\)</article><p id="p-116">The first reduction that we can make is a <dfn class="terminology">collision algorithm</dfn>: we make lists and look for a match that unlocks the problem. The method, due to Shank in the 1960s, prefigures the rise of the DLP as a cryptographic theme.</p>
<article class="theorem-like" id="algorithm-6"><h6 class="heading">
<span class="type">Algorithm</span> <span class="codenumber">3.6.3</span>. <span class="title">babystep-giantstep.</span>
</h6>
<p id="p-117">Let \(G\) be a group, \(g\in G\) an element of order \(N\geq 2\text{.}\) The following procedure solves the DLP \(g^x = h\) in \(\mathcal O(\sqrt{N} \log N)\) steps.</p>
<ol class="decimal">
<li id="li-99">Let \(n = 1 + \lfloor N \rfloor\) where \(\lfloor \cdot \rfloor\) is the floor function.</li>
<li id="li-100">Create two lists:<div class="displaymath">
\begin{equation*}
\begin{array}{ccccccc}
e \amp g \amp g^2 \amp g^3 \amp \ldots \amp g^n \amp \text{:babystep} \\
h \amp h\cdot g^{-n} \amp h\cdot g^{-2n}\amp h\cdot g^{-3n} \amp \ldots \amp h\cdot g^{-n^2} \amp \text{:giantstep}
\end{array}
\end{equation*}
</div>
</li>
<li id="li-101">The list will contain a collision. Suppose that<div class="displaymath">
\begin{equation*}
g^i = h\cdot g^{-jn} \text{ for integers } i,j.
\end{equation*}
</div>
</li>
<li id="li-102">Then \(g^{i+jn} = h\) and so set \(x = i+nj\text{.}\)</li>
</ol></article><p id="p-118">Some obvious questions should arise on seeing this algorithm. The first is why we should expect a match at all? The answer is in the application of the humble yet consistently useful division algorithm. Suppose that \(x\) was the exponent so that \(g^x = h\text{.}\) Divide \(x\) by \(n\) and write \(x = nq + r\text{,}\) where \(0 \leq r \lt n\text{,}\) and further note that \(0 \leq q \lt n\text{.}\) To see this, since \(1\leq x \lt N\) (the order of an element in a finite group divides and thus is no larger than the order of the group)</p>
<div class="displaymath">
\begin{equation*}
q = \frac{x - r}{n} \lt \frac{N}{n} \lt n
\end{equation*}
</div>
<p>where the last inequality follows from the fact that \(n \gt \sqrt{N}\text{.}\) Then since \(g^x = h\text{,}\) we get \(g^r = h\cdot g^{-nq}\text{,}\) where \(g^r\) is in the babystep list, and \(h \cdot g^{-nq}\) is in the giantstep list.</p>
<p id="p-119">The second question concerns the speed of the computation. Step 2 takes \(2n\) multiplications, and sorting the lists in Step 3 to find a match can be done in \(n \log n\) steps. Combined, then, steps 2 and 3 are</p>
<div class="displaymath">
\begin{equation*}
\mathcal O(n) + \mathcal O(n\log n) = \mathcal O(n \log n) = \mathcal O(\sqrt{N}\log\sqrt{N}) = \mathcal O(\sqrt{N} \log N).
\end{equation*}
</div>
<p>Convincing yourself that the estimates above are valid will go along way to clarifying the concept of big O notation.</p>
<p id="p-120">The resulting algorithm is still exponential: since \(N\) is on the order of \(2^k\text{,}\) the routine is \(\mathcal O(\sqrt{2^k} \log 2^k) = \mathcal O(k \cdot 2^{k/2})\text{.}\) However, when dealing with numbers on the order of the constants typically involved in cryptography, \(N\) to \(\sqrt{N}\) is a significant savings.</p>
<section class="exercises" id="exercises-11"><h3 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber"></span> <span class="title">Exercises</span>
</h3>
<article class="exercise-like" id="exercise-23"><h6 class="heading"><span class="codenumber">1.</span></h6>Implement the babystep-giantstep algorithm. The function should take as input a prime \(p\text{,}\) a base \(g\text{,}\) and a number \(h = g^x\text{,}\) and as output should produce the exponent \(x\text{.}\)</article></section></section></div></main>
</div>
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.12/login.js"></script>
</body>
</html>
