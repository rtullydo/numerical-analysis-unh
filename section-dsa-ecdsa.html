<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-11-21T15:45:43-05:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>DSA and Elliptic Curve DSA</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.12/pretext.js"></script><script src="https://pretextbook.org/js/0.12/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/toc.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/setcolors.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.12;
</script>
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\DeclareMathOperator{\RE}{Re}
\DeclareMathOperator{\IM}{Im}
\DeclareMathOperator{\ess}{ess}
\DeclareMathOperator{\intr}{int}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator\re{\mathrm {Re~}}
\DeclareMathOperator\im{\mathrm {Im~}}
\newcommand\dd{\mathrm d}
\newcommand{\eps}{\varepsilon}
\newcommand{\To}{\longrightarrow}
\newcommand{\hilbert}{\mathcal{H}}
\newcommand{\s}{\mathcal{S}_2}
\newcommand{\A}{\mathcal{A}}
\newcommand\h{\mathcal{H}}
\newcommand{\J}{\mathcal{J}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathcal{N}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\W}{\mathcal{W}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\D}{\mathbb{D}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\BOP}{\mathbf{B}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\BH}{\mathbf{B}(\mathcal{H})}
\newcommand{\KH}{\mathcal{K}(\mathcal{H})}
\newcommand{\pick}{\mathcal{P}_2}
\newcommand{\schur}{\mathcal{S}_2}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Complex}{\mathbb{C}}
\newcommand{\Field}{\mathbb{F}}
\newcommand{\RPlus}{\Real^{+}}
\newcommand{\Polar}{\mathcal{P}_{\s}}
\newcommand{\Poly}{\mathcal{P}(E)}
\newcommand{\EssD}{\mathcal{D}}
\newcommand{\Lop}{\mathcal{L}}
\newcommand{\cc}[1]{\overline{#1}}
\newcommand{\abs}[1]{\left\vert#1\right\vert}
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\seq}[1]{\left\lt#1\right&gt;}
\newcommand{\norm}[1]{\left\Vert#1\right\Vert}
\newcommand{\essnorm}[1]{\norm{#1}_{\ess}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\ran}[1]{\operatorname{ran}#1}
\newcommand{\nt}{\stackrel{\mathrm {nt}}{\to}}
\newcommand{\pnt}{\xrightarrow{pnt}}
\newcommand{\ip}[2]{\left\langle #1, #2 \right\rangle}
\newcommand{\ad}{^\ast}
\newcommand{\inv}{^{-1}}
\newcommand{\adinv}{^{\ast -1}}
\newcommand{\invad}{^{-1 \ast}}
\newcommand\Pick{\mathcal P}
\newcommand\Ha{\mathbb{H}}
\newcommand{\HH}{\Ha\times\Ha}
\newcommand\Htau{\mathbb{H}(\tau)}
\newcommand{\vp}{\varphi}
\newcommand{\ph}{\varphi}
\newcommand\al{\alpha}
\newcommand\ga{\gamma}
\newcommand\de{\delta}
\newcommand\ep{\varepsilon}
\newcommand\la{\lambda}
\newcommand\up{\upsilon}
\newcommand\si{\sigma}
\newcommand\beq{\begin{equation}}
\newcommand\ds{\displaystyle}
\newcommand\eeq{\end{equation}}
\newcommand\df{\stackrel{\rm def}{=}}
\newcommand\ii{\mathrm i}
\newcommand{\vectwo}[2]
{
   \begin{pmatrix} #1 \\ #2 \end{pmatrix}
}
\newcommand{\vecthree}[3]
{
   \begin{pmatrix} #1 \\ #2 \\ #3 \end{pmatrix}
}
\newcommand\blue{\color{blue}}
\newcommand\black{\color{black}}
\newcommand\red{\color{red}}
\newcommand\nn{\nonumber}
\newcommand\bbm{\begin{bmatrix}}
\newcommand\ebm{\end{bmatrix}}
\newcommand\bpm{\begin{pmatrix}}
\newcommand\epm{\end{pmatrix}}
\numberwithin{equation}{section}
\newcommand\nin{\noindent}
\newcommand{\nCr}[2]{\,_{#1}C_{#2}} 
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="cryptography.html"><span class="title">Mathematical Cryptography</span></a></h1>
<p class="byline">Ryan Tully-Doyle</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="section-subgroups.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="chapter-digital-signatures.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="section-bitcoin.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="section-subgroups.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="chapter-digital-signatures.html" title="Up">Up</a><a class="next-button button toolbar-item" href="section-bitcoin.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link"><a href="frontmatter-1.html" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a></li>
<li class="link">
<a href="chapter-intro.html" data-scroll="chapter-intro"><span class="codenumber">1</span> <span class="title">Preliminaries</span></a><ul>
<li><a href="foreward.html" data-scroll="foreward">The course</a></li>
<li><a href="motivation.html" data-scroll="motivation">Why “mathematical” cryptography?</a></li>
<li><a href="shift.html" data-scroll="shift">A simple example: the shift cipher</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-numbertheory.html" data-scroll="chapter-numbertheory"><span class="codenumber">2</span> <span class="title">Number theory</span></a><ul>
<li><a href="divisibility.html" data-scroll="divisibility">Integers and divisibility</a></li>
<li><a href="section-euclidean.html" data-scroll="section-euclidean">Common divisors and the Euclidean algorithm</a></li>
<li><a href="section-modular.html" data-scroll="section-modular">Modular arithmetic and the ring of integers modulo \(n\)</a></li>
<li><a href="section-fastpower.html" data-scroll="section-fastpower">The fast powering algorithm</a></li>
<li><a href="section-finite-fields.html" data-scroll="section-finite-fields">Finite fields</a></li>
<li><a href="section-fermat.html" data-scroll="section-fermat">Fermat's little theorem and computing inverses</a></li>
<li><a href="section-ch2-conclusion.html" data-scroll="section-ch2-conclusion">Conclusion</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-groups.html" data-scroll="chapter-groups"><span class="codenumber">3</span> <span class="title">Group based methods</span></a><ul>
<li><a href="section-naive.html" data-scroll="section-naive">A naïve cryptosystem and some related questions</a></li>
<li><a href="section-discretelog.html" data-scroll="section-discretelog">Discrete logarithms</a></li>
<li><a href="section-dh.html" data-scroll="section-dh">Diffie-Hellman key exchange</a></li>
<li><a href="section-elgamal.html" data-scroll="section-elgamal">The Elgamal cryptosystem</a></li>
<li><a href="section-groups.html" data-scroll="section-groups">Groups</a></li>
<li><a href="section-attack-dlp.html" data-scroll="section-attack-dlp">Attacking the discrete log problem</a></li>
<li><a href="section-chinese.html" data-scroll="section-chinese">The Chinese Remainder theorem and Pohlig-Hellman*</a></li>
<li><a href="section-homomorphism.html" data-scroll="section-homomorphism">Homomorphisms and the lunchtime attack</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-elliptic-curves.html" data-scroll="chapter-elliptic-curves"><span class="codenumber">4</span> <span class="title">Elliptic curves and applications</span></a><ul>
<li><a href="section-ec-intro.html" data-scroll="section-ec-intro">Introduction to elliptic curves</a></li>
<li><a href="section-elliptic-addition.html" data-scroll="section-elliptic-addition">Elliptic addition on \(E\text{.}\)</a></li>
<li><a href="section-ec-finite-fields.html" data-scroll="section-ec-finite-fields">Elliptic curves over finite fields</a></li>
<li><a href="section-ecdlp.html" data-scroll="section-ecdlp">Discrete logs and the ECDLP</a></li>
<li><a href="section-ec-elgamal.html" data-scroll="section-ec-elgamal">Elliptic curve Diffie-Hellman key exchange and El Gamal</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-digital-signatures.html" data-scroll="chapter-digital-signatures"><span class="codenumber">5</span> <span class="title">Digital signatures</span></a><ul>
<li><a href="section-dsa-intro.html" data-scroll="section-dsa-intro">Introduction to digital signatures</a></li>
<li><a href="section-elgamal-ds.html" data-scroll="section-elgamal-ds">Elgamal digital signatures</a></li>
<li><a href="section-subgroups.html" data-scroll="section-subgroups">Subgroups and cyclic subgroups</a></li>
<li><a href="section-dsa-ecdsa.html" data-scroll="section-dsa-ecdsa" class="active">DSA and Elliptic Curve DSA</a></li>
<li><a href="section-bitcoin.html" data-scroll="section-bitcoin">Bitcoin - an application of ECDSA*</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-probability.html" data-scroll="chapter-probability"><span class="codenumber">6</span> <span class="title">Probability and non-deterministic methods</span></a><ul>
<li><a href="section-counting.html" data-scroll="section-counting">Counting*</a></li>
<li><a href="section-perm-comb.html" data-scroll="section-perm-comb">Permutations and combinations*</a></li>
<li><a href="section-prime-testing.html" data-scroll="section-prime-testing">Primality testing</a></li>
<li><a href="section-pollard-concrete.html" data-scroll="section-pollard-concrete">Pollard's \(\rho\) method</a></li>
</ul>
</li>
<li class="link"><a href="backmatter-1.html" data-scroll="backmatter-1"><span class="title">Back Matter</span></a></li>
<li class="link"><a href="code.html" data-scroll="code"><span class="codenumber">A</span> <span class="title">Code repository</span></a></li>
<li class="link">
<a href="chapter-7.html" data-scroll="chapter-7"><span class="codenumber">7</span> <span class="title">Exercises</span></a><ul>
<li><a href="exercises-21.html" data-scroll="exercises-21">Set 1</a></li>
<li><a href="exercises-22.html" data-scroll="exercises-22">Set 2</a></li>
<li><a href="exercises-23.html" data-scroll="exercises-23">Set 3</a></li>
<li><a href="exercises-24.html" data-scroll="exercises-24">Set 4</a></li>
</ul>
</li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="section-dsa-ecdsa"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">5.4</span> <span class="title">DSA and Elliptic Curve DSA</span>
</h2>
<a href="section-dsa-ecdsa.html" class="permalink">¶</a><p id="p-188">The <em class="emphasis">Digital Signature Algorithm</em> is a system that takes advantage of the existence of cyclic subgroups of smaller order in \(\F_p\text{.}\) Choosing a large prime \(p\) will keep the core discrete log problem intractable using contemporary methods like the index calculus, while finding a much smaller subgroup keeps the computation and storage requirements reasonable for users. (That is, while \(p\) might be on the order of \(2^{2048}\text{,}\) the subgroup used for the verification is on the order of \(q \sim 2^{512}\text{,}\) for example.)</p>
<article class="theorem-like" id="alg-dsa"><h6 class="heading">
<span class="type">Algorithm</span> <span class="codenumber">5.4.1</span>. <span class="title">Digital Signature Algorithm (DSA).</span>
</h6>
<ol class="decimal">
<li id="li-173">(public parameters) Sam chooses a large primes \(p, q\) satisfying \(p \equiv 1 \bmod p\) and an element \(g\) of order \(q\) modulo \(p\text{.}\)</li>
<li id="li-174">(private) Sam chooses a private key \(1 \lt a \lt q-1\) and computes \(A = g^a\text{.}\)</li>
<li id="li-175">(public) Sam publishes \(p,q, g, A\text{.}\)</li>
<li id="li-176">(private) Sam wishes to sign a document \(D\) where \(1 \leq D \lt q\text{.}\) She picks a random element \(1 \lt k \lt q\text{.}\) She computes<div class="displaymath">
\begin{equation*}
S_1 = g^k \bmod q, \hspace{.5cm} S_2 = (D - aS_1)k\inv \bmod q.
\end{equation*}
</div>Her signature is the pair \(D^{sig} = (S_1, S_2)\text{.}\)</li>
<li id="li-177">(private) Vera receives the document \(D\text{,}\) the signature \(D^{sig}\) and the public signing key \(p,q, g, A\text{.}\) She wants to verify that the document comes from Sam.</li>
<li id="li-178">(private) Vera computes the verification constants<div class="displaymath">
\begin{equation*}
V_1 = D S_1\inv,\hspace{.5cm} V_2 = S_1 S_2\inv
\end{equation*}
</div>
</li>
<li id="li-179">Vera's verification question is:<div class="displaymath">
\begin{equation}
\text{Is } (g^{V_1}A^{V_2}\bmod p) \bmod q= S_1 \text{?}\label{eq-dsa}\tag{5.4.1}
\end{equation}
</div>
</li>
</ol></article><p id="p-189">As is the running theme with elliptic curves, the DSA is easily implemented with elliptic curves in place of the finite field \(\F_p\text{.}\) The advantage is that the ONLY way currently known to attack the discrete log problem in robust elliptic curves is with exponential routines. The Digital Signature Algorithm with elliptic curves is called ECDSA and is in common usage. One of the more surprising applications is in the realm of cryptocurrecy, to be discussed in a sequel section.</p>
<article class="theorem-like" id="alg-ecdsa"><h6 class="heading">
<span class="type">Algorithm</span> <span class="codenumber">5.4.2</span>. <span class="title">Elliptic Curve Digital Signature Algorithm (ECDSA).</span>
</h6>
<ol class="decimal">
<li id="li-180">(public parameters) Sam chooses an elliptic curve over a finite field \(E(\F_p)\) and a point \(G \in E(\F_p)\) of large prime order \(q\text{.}\)</li>
<li id="li-181">(private) Sam chooses a private key \(1 \lt a \lt q-1\) and computes \(A = sG\text{.}\)</li>
<li id="li-182">(public) Sam publishes \(p,q, G, A\text{.}\)</li>
<li id="li-183">(private) Sam wishes to sign a document \(D\) where \(1 \leq D \lt q\text{.}\) She picks a random element \(1 \lt k \lt q\text{.}\) She computes<div class="displaymath">
\begin{equation*}
kG = (x_k, y_k)
\end{equation*}
</div>and then sets<div class="displaymath">
\begin{equation*}
s_1 = x_k, \hspace{.5cm} s_2 = (D + ax_k)k\inv \bmod q.
\end{equation*}
</div>Her signature is the pair \(D^{sig} = (s_1, s_2)\text{.}\)</li>
<li id="li-184">(private) Vera receives the document \(D\text{,}\) the signature \(D^{sig}\) and the public signing key \(p,q, G, A\text{.}\) She wants to verify that the document comes from Sam.</li>
<li id="li-185">(private) Vera computes the verification constants<div class="displaymath">
\begin{equation*}
v_1 = D s_2\inv,\hspace{.5cm} v_2 = x s_2\inv
\end{equation*}
</div>
</li>
<li id="li-186">Vera's verification question is:<div class="displaymath">
\begin{equation}
\text{Is } (v_1 G + v_2 A) \bmod q = x \text{?}\label{eq-ecdsa}\tag{5.4.2}
\end{equation}
</div>
</li>
</ol></article><section class="exercises" id="exercises-18"><h3 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber"></span> <span class="title">Exercises</span>
</h3>
<article class="exercise-like" id="exercise-36"><h6 class="heading"><span class="codenumber">1.</span></h6>Show that the verification question in the DSA is true if the information that Vera receives from Sam is correct.</article><article class="exercise-like" id="exercise-37"><h6 class="heading"><span class="codenumber">2.</span></h6>Show that the verification question in <a data-knowl="./knowl/alg-ecdsa.html" title="Algorithm 5.4.2: Elliptic Curve Digital Signature Algorithm (ECDSA)">Algorithm 5.4.2</a> is true if the information that Vera receives is correct.</article></section></section></div></main>
</div>
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.12/login.js"></script>
</body>
</html>
