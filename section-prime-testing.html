<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-11-21T15:45:43-05:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Primality testing</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script>$(function () {
    // Make *any* div with class 'sagecell-sage' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-sage',
                           linked: true,
                           languages: ['sage'],
                           evalButtonText: 'Evaluate (Sage)'});
});
</script><script>$(function () {
    // Make *any* div with class 'sagecell-python' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-python',
                           linked: true,
                           languages: ['python'],
                           evalButtonText: 'Evaluate (Python)'});
});
</script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.12/pretext.js"></script><script src="https://pretextbook.org/js/0.12/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/toc.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/setcolors.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.12;
</script>
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\DeclareMathOperator{\RE}{Re}
\DeclareMathOperator{\IM}{Im}
\DeclareMathOperator{\ess}{ess}
\DeclareMathOperator{\intr}{int}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator\re{\mathrm {Re~}}
\DeclareMathOperator\im{\mathrm {Im~}}
\newcommand\dd{\mathrm d}
\newcommand{\eps}{\varepsilon}
\newcommand{\To}{\longrightarrow}
\newcommand{\hilbert}{\mathcal{H}}
\newcommand{\s}{\mathcal{S}_2}
\newcommand{\A}{\mathcal{A}}
\newcommand\h{\mathcal{H}}
\newcommand{\J}{\mathcal{J}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathcal{N}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\W}{\mathcal{W}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\D}{\mathbb{D}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\BOP}{\mathbf{B}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\BH}{\mathbf{B}(\mathcal{H})}
\newcommand{\KH}{\mathcal{K}(\mathcal{H})}
\newcommand{\pick}{\mathcal{P}_2}
\newcommand{\schur}{\mathcal{S}_2}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Complex}{\mathbb{C}}
\newcommand{\Field}{\mathbb{F}}
\newcommand{\RPlus}{\Real^{+}}
\newcommand{\Polar}{\mathcal{P}_{\s}}
\newcommand{\Poly}{\mathcal{P}(E)}
\newcommand{\EssD}{\mathcal{D}}
\newcommand{\Lop}{\mathcal{L}}
\newcommand{\cc}[1]{\overline{#1}}
\newcommand{\abs}[1]{\left\vert#1\right\vert}
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\seq}[1]{\left\lt#1\right&gt;}
\newcommand{\norm}[1]{\left\Vert#1\right\Vert}
\newcommand{\essnorm}[1]{\norm{#1}_{\ess}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\ran}[1]{\operatorname{ran}#1}
\newcommand{\nt}{\stackrel{\mathrm {nt}}{\to}}
\newcommand{\pnt}{\xrightarrow{pnt}}
\newcommand{\ip}[2]{\left\langle #1, #2 \right\rangle}
\newcommand{\ad}{^\ast}
\newcommand{\inv}{^{-1}}
\newcommand{\adinv}{^{\ast -1}}
\newcommand{\invad}{^{-1 \ast}}
\newcommand\Pick{\mathcal P}
\newcommand\Ha{\mathbb{H}}
\newcommand{\HH}{\Ha\times\Ha}
\newcommand\Htau{\mathbb{H}(\tau)}
\newcommand{\vp}{\varphi}
\newcommand{\ph}{\varphi}
\newcommand\al{\alpha}
\newcommand\ga{\gamma}
\newcommand\de{\delta}
\newcommand\ep{\varepsilon}
\newcommand\la{\lambda}
\newcommand\up{\upsilon}
\newcommand\si{\sigma}
\newcommand\beq{\begin{equation}}
\newcommand\ds{\displaystyle}
\newcommand\eeq{\end{equation}}
\newcommand\df{\stackrel{\rm def}{=}}
\newcommand\ii{\mathrm i}
\newcommand{\vectwo}[2]
{
   \begin{pmatrix} #1 \\ #2 \end{pmatrix}
}
\newcommand{\vecthree}[3]
{
   \begin{pmatrix} #1 \\ #2 \\ #3 \end{pmatrix}
}
\newcommand\blue{\color{blue}}
\newcommand\black{\color{black}}
\newcommand\red{\color{red}}
\newcommand\nn{\nonumber}
\newcommand\bbm{\begin{bmatrix}}
\newcommand\ebm{\end{bmatrix}}
\newcommand\bpm{\begin{pmatrix}}
\newcommand\epm{\end{pmatrix}}
\numberwithin{equation}{section}
\newcommand\nin{\noindent}
\newcommand{\nCr}[2]{\,_{#1}C_{#2}} 
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="cryptography.html"><span class="title">Mathematical Cryptography</span></a></h1>
<p class="byline">Ryan Tully-Doyle</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="section-perm-comb.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="chapter-probability.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="section-pollard-concrete.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="section-perm-comb.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="chapter-probability.html" title="Up">Up</a><a class="next-button button toolbar-item" href="section-pollard-concrete.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link"><a href="frontmatter-1.html" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a></li>
<li class="link">
<a href="chapter-intro.html" data-scroll="chapter-intro"><span class="codenumber">1</span> <span class="title">Preliminaries</span></a><ul>
<li><a href="foreward.html" data-scroll="foreward">The course</a></li>
<li><a href="motivation.html" data-scroll="motivation">Why “mathematical” cryptography?</a></li>
<li><a href="shift.html" data-scroll="shift">A simple example: the shift cipher</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-numbertheory.html" data-scroll="chapter-numbertheory"><span class="codenumber">2</span> <span class="title">Number theory</span></a><ul>
<li><a href="divisibility.html" data-scroll="divisibility">Integers and divisibility</a></li>
<li><a href="section-euclidean.html" data-scroll="section-euclidean">Common divisors and the Euclidean algorithm</a></li>
<li><a href="section-modular.html" data-scroll="section-modular">Modular arithmetic and the ring of integers modulo \(n\)</a></li>
<li><a href="section-fastpower.html" data-scroll="section-fastpower">The fast powering algorithm</a></li>
<li><a href="section-finite-fields.html" data-scroll="section-finite-fields">Finite fields</a></li>
<li><a href="section-fermat.html" data-scroll="section-fermat">Fermat's little theorem and computing inverses</a></li>
<li><a href="section-ch2-conclusion.html" data-scroll="section-ch2-conclusion">Conclusion</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-groups.html" data-scroll="chapter-groups"><span class="codenumber">3</span> <span class="title">Group based methods</span></a><ul>
<li><a href="section-naive.html" data-scroll="section-naive">A naïve cryptosystem and some related questions</a></li>
<li><a href="section-discretelog.html" data-scroll="section-discretelog">Discrete logarithms</a></li>
<li><a href="section-dh.html" data-scroll="section-dh">Diffie-Hellman key exchange</a></li>
<li><a href="section-elgamal.html" data-scroll="section-elgamal">The Elgamal cryptosystem</a></li>
<li><a href="section-groups.html" data-scroll="section-groups">Groups</a></li>
<li><a href="section-attack-dlp.html" data-scroll="section-attack-dlp">Attacking the discrete log problem</a></li>
<li><a href="section-chinese.html" data-scroll="section-chinese">The Chinese Remainder theorem and Pohlig-Hellman*</a></li>
<li><a href="section-homomorphism.html" data-scroll="section-homomorphism">Homomorphisms and the lunchtime attack</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-elliptic-curves.html" data-scroll="chapter-elliptic-curves"><span class="codenumber">4</span> <span class="title">Elliptic curves and applications</span></a><ul>
<li><a href="section-ec-intro.html" data-scroll="section-ec-intro">Introduction to elliptic curves</a></li>
<li><a href="section-elliptic-addition.html" data-scroll="section-elliptic-addition">Elliptic addition on \(E\text{.}\)</a></li>
<li><a href="section-ec-finite-fields.html" data-scroll="section-ec-finite-fields">Elliptic curves over finite fields</a></li>
<li><a href="section-ecdlp.html" data-scroll="section-ecdlp">Discrete logs and the ECDLP</a></li>
<li><a href="section-ec-elgamal.html" data-scroll="section-ec-elgamal">Elliptic curve Diffie-Hellman key exchange and El Gamal</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-digital-signatures.html" data-scroll="chapter-digital-signatures"><span class="codenumber">5</span> <span class="title">Digital signatures</span></a><ul>
<li><a href="section-dsa-intro.html" data-scroll="section-dsa-intro">Introduction to digital signatures</a></li>
<li><a href="section-elgamal-ds.html" data-scroll="section-elgamal-ds">Elgamal digital signatures</a></li>
<li><a href="section-subgroups.html" data-scroll="section-subgroups">Subgroups and cyclic subgroups</a></li>
<li><a href="section-dsa-ecdsa.html" data-scroll="section-dsa-ecdsa">DSA and Elliptic Curve DSA</a></li>
<li><a href="section-bitcoin.html" data-scroll="section-bitcoin">Bitcoin - an application of ECDSA*</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-probability.html" data-scroll="chapter-probability"><span class="codenumber">6</span> <span class="title">Probability and non-deterministic methods</span></a><ul>
<li><a href="section-counting.html" data-scroll="section-counting">Counting*</a></li>
<li><a href="section-perm-comb.html" data-scroll="section-perm-comb">Permutations and combinations*</a></li>
<li><a href="section-prime-testing.html" data-scroll="section-prime-testing" class="active">Primality testing</a></li>
<li><a href="section-pollard-concrete.html" data-scroll="section-pollard-concrete">Pollard's \(\rho\) method</a></li>
</ul>
</li>
<li class="link"><a href="backmatter-1.html" data-scroll="backmatter-1"><span class="title">Back Matter</span></a></li>
<li class="link"><a href="code.html" data-scroll="code"><span class="codenumber">A</span> <span class="title">Code repository</span></a></li>
<li class="link">
<a href="chapter-7.html" data-scroll="chapter-7"><span class="codenumber">7</span> <span class="title">Exercises</span></a><ul>
<li><a href="exercises-21.html" data-scroll="exercises-21">Set 1</a></li>
<li><a href="exercises-22.html" data-scroll="exercises-22">Set 2</a></li>
<li><a href="exercises-23.html" data-scroll="exercises-23">Set 3</a></li>
<li><a href="exercises-24.html" data-scroll="exercises-24">Set 4</a></li>
</ul>
</li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="section-prime-testing"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">6.3</span> <span class="title">Primality testing</span>
</h2>
<a href="section-prime-testing.html" class="permalink">¶</a><p id="p-199">One of the most important areas where non-deterministic methods are used in cryptography is in the area of producing and testing numbers that are highly likely to be prime - that is, it is quite expensive to determine with absolute certainty that a number \(n\) is prime, but it can be checked to any amount of desired likelihood. (Such primes are sometimes referred to as <dfn class="terminology">industrial-grade primes</dfn> - that is, good enough for application.) The idea is that even if the tests miss an occasional number that isn't prime, it happens so infrequently that the economic cost of looking for one is prohibitive.</p>
<p id="p-200">Recall that a <dfn class="terminology">composite number</dfn> is a number that has two or more non-trivial factors. We'll begin by looking at conditions that prime numbers <em class="emphasis">always</em> satisfy. What springs to mind is Fermat's little theorem <a data-knowl="./knowl/thm-fermat.html" title="Theorem 2.6.1: (Fermat's little theorem)">Theorem 2.6.1</a>. We will adopt a slightly modified version that removes the restrictions on \(a\text{.}\)</p>
<article class="theorem-like" id="thm-fermat-2"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">6.3.1</span>. <span class="title">Modified Fermat's theorem.</span>
</h6>\(p\)\(a\)<div class="displaymath">
\begin{equation*}
a^p \equiv a \bmod p.
\end{equation*}
</div></article><p id="p-201">Fermat's little theorem gives us a test for compositeness: if \(a^p \neq a \bmod p\text{,}\) then \(p\) cannot be prime. For example, suppose that we want to know if \(n = 9\) is prime (presuming that we don't know how to factor it). On checking the Fermat condition for say \(a = 2\text{,}\) we see that</p>
<div class="displaymath">
\begin{equation*}
2^9 \equiv 8 \bmod 9
\end{equation*}
</div>
<p>and so \(9\) (shockingly) cannot be prime. This sort of test is exclusive -- we can exclude numbers that fail, but passing the test for a given value of \(a\) <em class="emphasis">does not mean that \(n\) is prime!</em> For example,</p>
<div class="displaymath">
\begin{equation*}
6^{21} \equiv 6 \bmod 21
\end{equation*}
</div>
<p>and yet 21 is obviously not prime.</p>
<p id="p-202">We take the position that 2 “sees” the compositeness of 9, but that 6 does not see the compositeness of 21. In this light, we define the notion of a witness of compositeness.</p>
<article class="definition-like" id="def-witness"><h6 class="heading">
<span class="type">Definition</span> <span class="codenumber">6.3.2</span>.</h6>A number \(a\) is said to be a (Fermat) <dfn class="terminology">witness</dfn> for the compositeness of a composite number \(n\) if<div class="displaymath">
\begin{equation*}
a^n \neq a \bmod n.
\end{equation*}
</div></article><p id="p-203">We're left with the following idea: If we suspect that a number \(n\) is prime, check lots of numbers \(a\) as potential witnesses of the compositeness of \(n\text{.}\) If we don't find any witnesses, perhaps we could conclude that \(n\) is prime. The issue with this approach is the existence of a set of numbers called <em class="emphasis">Carmichael numbers</em>, which have the property of possessing <em class="emphasis">no</em> Fermat witnesses. As an example, \(n = 531 = 3 \cdot 11 \cdot 17\) has the property that</p>
<div class="displaymath">
\begin{equation*}
a^{531} = a \bmod 531
\end{equation*}
</div>
<p>for <em class="emphasis">every</em> integer \(a\text{,}\) and thus has no witnesses to the fact that it is composite. There are infintely many Carmichael numbers, and so it behooves us to develop a test so that every composite \(n\) has lots of witnesses.</p>
<p id="p-204">One such test is called the Miller-Rabin test, which relies on Fermat's little theorem as its background assumption but provides a further discrimination that gives every composite number lots of witnesses.</p>
<article class="theorem-like" id="thm-mr-condition"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">6.3.3</span>.</h6>\(p\)<div class="displaymath">
\begin{equation*}
p - 1 = 2^k q \text{ where } q \text{ is odd.}
\end{equation*}
</div>\(a\)\(p \nmid a\text{.}\)<ol class="decimal">
<li id="li-187">\(a^q \equiv 1 \bmod p;\)</li>
<li id="li-188">A number in the list<div class="displaymath">
\begin{equation}
a^q, a^{2q}, a^{4q} \ldots, a^{2^{k-1}q}\label{eq-mr-list}\tag{6.3.1}
\end{equation}
</div>is congruent to \(-1 \bmod p\text{.}\)</li>
</ol></article><article class="hiddenproof" id="proof-7"><a data-knowl="" class="id-ref" data-refid="hk-proof-7"><h6 class="heading"><span class="type">Proof.</span></h6></a></article><div id="hk-proof-7" class="hidden-content tex2jax_ignore"><article class="hiddenproof">The basic idea of the proof is that \(\sqrt{1} = \pm 1\text{.}\) By Fermat's theorem, we know that<div class="displaymath">
\begin{equation*}
a^{2^k q} = a^{p-1} \equiv 1 \mod p.
\end{equation*}
</div>The list<div class="displaymath">
\begin{equation*}
a^q, a^{2q}, \ldots, a^{2^{k-1}q}, a^{2^k q} = 1
\end{equation*}
</div>is a list of repeated squarings. Since the last number is 1, the previous number must have been 1 or -1. If the previous number is -1, we're finished. If the previous number is 1, then the number prior to that much have been 1 or -1 and so on down the chain. If we reach the first number in the list, it must be 1 or -1 because the next number was 1. If it is -1, then we're done. If it is 1, we're in the first condition, completing the proof.</article></div> The theorem gives the underlying condition for the Miller-Rabin test for compositeness. <article class="definition-like" id="def-mr-witness"><h6 class="heading">
<span class="type">Definition</span> <span class="codenumber">6.3.4</span>.</h6>Let \(n\) be odd and write \(n-1 = 2^k q\) with \(q\) odd. An integer \(a\) with \(\gcd(a,n) = 1\) is a <dfn class="terminology">Miller-Rabin witness</dfn> for the compositeness of \(n\) if <ol class="decimal">
<li id="li-189">\(a^q \neq 1 \bmod n \) and</li>
<li id="li-190">\(a^{2^i q} \neq -1 \bmod n\) for any \(i = 1, \ldots, k-1\)</li>
</ol></article><p id="p-205">By <a data-knowl="./knowl/thm-mr-condition.html" title="Theorem 6.3.3">Theorem 6.3.3</a>, if \(n\) has a Miller-Rabin witness then it must be composite. Thus, we can formulate the Miller-Rabin test:</p>
<article class="theorem-like" id="algo-mr"><h6 class="heading">
<span class="type">Algorithm</span> <span class="codenumber">6.3.5</span>.</h6>\(n\)\(a\)<ol class="decimal">
<li id="li-191">If \(n\) is even, then \(n\) is composite.</li>
<li id="li-192">If \(1 \lt \gcd(a, n) \lt n\text{,}\) then \(n\) is composite.</li>
<li id="li-193">Write \(n - 1 = 2^k q\)</li>
<li id="li-194">Set \(a = a^q \bmod n\) and \(i=0\text{.}\)</li>
<li id="li-195">If \(a = 1 \bmod n\text{,}\) the test is inconclusive.</li>
<li id="li-196">If \(a = -1 \bmod n\text{,}\) the test is inconclusive.</li>
<li id="li-197">If \(i \lt k-1\text{,}\) set \(a = a^2 \mod n\text{,}\) increment \(i\text{,}\) and return to 6.</li>
<li id="li-198">Else \(n\) is composite.</li>
</ol></article><p id="p-206">Python note: the method for the step where all of the factors of 2 are pulled out of \(n-1\) might seem somewhat unclear. A useful command in this case is <code class="code-inline tex2jax_ignore">divmod</code>, which is the library function for division with remainder. A segment of hint code follows.</p>
<div class="sagecell-python" id="sage-11"><script type="text/x-sage">n = 37
m = n -1
i, q, r = 0,0,0
while True:
  q, r = divmod(m, 2)
  if r == 1:
    break
  m = q
  i = i + 1
print("%d has the form (2^%d)%d"%(n-1, i, m))
</script></div>
<p id="p-207">Composite numbers have lots of Miller-Rabin witnesses.</p>
<article class="theorem-like" id="proposition-4"><h6 class="heading">
<span class="type">Proposition</span> <span class="codenumber">6.3.6</span>.</h6>\(n\)\(1 \lt a \leq n-1\)\(n\text{.}\)</article><p id="p-208">In some sense, we have the basis for a nondeterministic test for the primeness of an integer now. We know that if \(n\) is composite, we have at least a 75% chance of finding a witness for any given \(a\) that we test. That is, we have a 25% chance at most to fail. If we try lots of values, and they all fail to be witnesses for \(n\text{,}\) then it becomes increasingly likely that \(n\) is prime.</p>
<p id="p-209">The situation is slighly complicated by the fact that the probabilities are what as known as <em class="emphasis">conditional</em>: that is, when \(n\) is composite, 25% of numbers fail to be witnesses, but when \(n\) is prime, 100% of numbers fail to be witnesses. Nevertheless, the basic intuition should be something like “If \(n\) is composite, then the probability that 10 numbers fail to be Miller-Rabin witnesses for \(n\) is \(.25^{10} \approx 10^{-6}\)”. That is, getting 10 or 100 or 1000 failed witnesses makes it exceedingly unlikely that \(n\) is composite. The exact calculation of the probability will have to wait until we have looked more closely at conditional probability.</p>
<p id="p-210">One might reasonably ask if there are efficient ways of generating candidate primes. In fact, there are many formulas that are much more likely to produce a prime than a random number generator. Further, we can exclude many possible values for \(n\) with divisibilty rules and quick divisions (say by every number up to 10000) before we apply a computationally expensive MR-test.</p>
<p id="p-211">Finally, I'll point out that there are deterministic methods for checking that a number is prime that run in polynomial time <em class="emphasis">but</em> these algorithms require that we assume the truth of perhaps the most famous and important unsolved problems in mathematics, the <dfn class="terminology">Riemann hypothesis</dfn>, which concerns the distribution of prime numbers in the real line. More than 150 years of work has gone into proving or disproving the hypothesis, which to the present has resisted giving up its secrets.</p>
<section class="exercises" id="exercises-19"><h3 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber"></span> <span class="title">Exercises</span>
</h3>
<article class="exercise-like" id="exercise-38"><h6 class="heading"><span class="codenumber">1.</span></h6>One naive way to deterministically check if a number \(n\) is prime is to divide it by every number between \(1\) and \(n-1\text{.}\) Show that you only need to check the integers \(1 \lt d \leq \sqrt{n}\text{.}\)</article><article class="exercise-like" id="exercise-39"><h6 class="heading"><span class="codenumber">2.</span></h6>Write a program to show that \(n = 1105\) is a Carmichael number.</article><article class="exercise-like" id="exercise-40"><h6 class="heading"><span class="codenumber">3.</span></h6>Implement the Miller-Rabin test for compositeness.</article></section></section></div></main>
</div>
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.12/login.js"></script>
</body>
</html>
