<!DOCTYPE html>
<html lang="en-US">
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2020-03-18T09:31:44-04:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>$(function () {
    // Make *any* div with class 'sagecell-sage' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-sage',
                           linked: true,
                           languages: ['sage'],
                           evalButtonText: 'Evaluate (Sage)'});
});
</script>
</head>
<body><article class="example-like"><p>Our previous example didn't have any \(t\)s to plug in. So suppose we have</p>
<div class="displaymath">
\begin{equation*}
\frac{dy}{dt}=-2ty^{2},\quad y(0)=1,\quad h=\frac{1}{2}
\end{equation*}
</div>
<ol class="decimal">
<li>Our first point is \((t_{0},y_{0})=\left(0,1\right)\text{.}\)</li>
<li>We can compute the formula for this and get \(t_{k+1}=t_{k}+.5\) and notice that \(f\left(t,y\right)=-2ty^{2}\text{.}\)<div class="displaymath">
\begin{equation*}
y_{k+1}=y_{k}+f\left(t_{k},y_{k}\right)h=y_{k}+\left(-2t_{k}y_{k}^{2}\right)(\frac{1}{2}).
\end{equation*}
</div>
</li>
<li>
<p>Make a table:</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{|c|c|c|c|}
\hline
k \amp t_{k} \amp y_{k}=y_{k-1}+f\left(t_{k-1},y_{k-1}\right)h \amp f\left(t_{k},y_{k}\right)=-2t_{k}y_{k}^{2}\\
\hline
\hline
0 \amp 0 \amp 1 \amp 0\\
\hline
1 \amp \frac{1}{2} \amp y_{1}=1+0\cdot(\frac{1}{2})=\mathbf{1} \amp f\left(t_{1},y_{1}\right)=-2\frac{1}{2}1^{1}=\mathbf{-1}\\
\hline
2 \amp 1 \amp y_{2}=1+(-1)\cdot(\frac{1}{2})=\mathbf{\frac{1}{2}} \amp f\left(t_{2},y_{2}\right)=-2(1)(\frac{1}{2})^{2}=\mathbf{-\frac{1}{2}}\\
\hline
3 \amp 1.5=\frac{3}{2} \amp y_{3}=\frac{1}{2}+(-\frac{1}{2})\cdot(\frac{1}{2})=\frac{1}{4} \amp f\left(t_{3},y_{3}\right)=-2(\frac{3}{2})(\frac{1}{4})^{2}=\mathbf{-\frac{3}{16}}\\
\hline
4 \amp 2 \amp \frac{1}{4}+\left(-\frac{3}{16}\right)\cdot\left(\frac{1}{2}\right)=.15625 \amp \\
\hline
\end{array}
\end{equation*}
</div>
</li>
</ol>
<p>A plot of our approximate solution is given below:</p>
<div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="images/1.4-1.png" style="width: 100%; height: auto;" alt=""></div>
<p>In code, this might look like</p>
<div class="sagecell-sage" id="sage-19"><script type="text/x-sage">var('t,y')
f(t, y) = -2*t*y^2
t0 = 0
y0 = 1
A = plot_slope_field(f, (0,3), (-1,3))

#approximate solution by Euler's method
h = .5
time = [t0 + n*h for n in range(5)]
yk = [y0]
def ynext(n):
    return yk[n-1] + f(time[n-1], yk[n-1])*h
for i in range(1,5):
    yk.append(ynext(i))
L = [[time[i], yk[i]] for i in range(5)]
B = line(L)

#actual solution
g(t) = 1/(t^2 + 1)
C = plot(g, (0,2), color = "red")
A + B + C
</script></div></article></body>
</html>
