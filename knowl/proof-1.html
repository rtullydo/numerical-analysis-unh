<!DOCTYPE html>
<html lang="en-US">
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2020-03-18T09:31:45-04:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body>
<article class="hiddenproof"><h6 class="heading"><span class="type">Proof</span></h6>
<p>Let \(\Delta x = x_{i+1} - x_i = \frac{b -a}{n}\text{.}\) We first analyze the error in the trapezoid approximation on a single interval. A \(u\)-substitution gives</p>
<div class="displaymath">
\begin{equation*}
\int_{x_i}^{x_{i+1}} f(x) \, dx = \int_0^{\Delta x} f(t + x_i) \, dt.
\end{equation*}
</div>
<p>Using integration by parts twice, we get <figure class="figure-like"><table>
<tr>
<td class="l m b2 r2 l0 t0 lines">\(u\)</td>
<td class="l m b2 r0 l0 t0 lines">\(v\)</td>
</tr>
<tr>
<td class="l m b0 r2 l0 t0 lines">\(f(t + x_i)\)</td>
<td class="l m b0 r0 l0 t0 lines">\(1\)</td>
</tr>
<tr>
<td class="l m b0 r2 l0 t0 lines">\(f'(t + x_i)\)</td>
<td class="l m b0 r0 l0 t0 lines">\(t + A\)</td>
</tr>
<tr>
<td class="l m b0 r2 l0 t0 lines">\(f''(t + x_i)\)</td>
<td class="l m b0 r0 l0 t0 lines">\(\frac{(t + A)^2}{2} + B\)</td>
</tr>
</table>
<figcaption><span class="type">Table</span> <span class="codenumber">6.3.</span> </figcaption></figure> where we forgo the usual choice of 0 as the integration constant (hence the \(A, B\) in the table), which gives the formula</p>
<div class="displaymath">
\begin{align*}
\amp\int_0^{\Delta x} f(t + x_i)\, dx \\
\amp = \left[(t+A)f(t+x_i)\right]_0^{\Delta x} \\
\amp - \left[\left(\frac{(t + A)^2}{2} + B\right)f'(t + x_i)\right]_0^{\Delta x}\\
\amp+ \int_0^{\Delta x} \left(\frac{(t + A)^2}{2} + B\right) f''(t + x_i)\, dx.
\end{align*}
</div>
<p>From this point, the idea is to choose values of \(A, B\) that force each term to play a certain role, with the goal of concentrating the error of the approximation in the integral term. First, we choose \(A\) so that the first term above is equal to the trapezoid area - that is, we want</p>
<div class="displaymath">
\begin{equation*}
(\Delta x + A) f(\Delta x + x_i) - Af(x_i) = \frac{f(x_{i+1}) + f(x_i)}{2} \Delta x.
\end{equation*}
</div>
<p>Algebra shows that \(A = \frac{-\Delta x}{2}\) solves the equation.</p>
<p>Now, we want to choose \(B\) so that the second term is zero. That is, we want</p>
<div class="displaymath">
\begin{align*}
\amp \left[\left(\frac{(t + A)^2}{2} + B\right)f'(t + x_i)\right]_0^{\Delta x} \\
\amp = \left(\frac{(\Delta x)^2}{8} + B\right)\left[f'(x_{i+1}) - f'(x_i)\right]= 0.
\end{align*}
</div>
<p>This obviously holds when \(B = \frac{-(\Delta x)^2}{8}\text{.}\)</p>
<p>We conclude that the error on the \(i\)th segment, denoted \(E_T(i)\) is given by</p>
<div class="displaymath">
\begin{equation*}
E_T(i) = \int_0^{\Delta x} \left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right) f''(t + x_i) \, dt
\end{equation*}
</div>
<p>Now, we can get the total error in the trapezoid approximation by adding each of the individual errors.</p>
<div class="displaymath">
\begin{align*}
E_T \amp= \sum E_T(i)\\
\amp = \sum_{i=0}^{n-1} \int_0^{\Delta x} \left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right) f''(t + x_i) \, dt \\
\amp =\int_0^{\Delta x} \left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right) \left(\sum_{i = 0}^{n-1} f''(t + x_i)\right) \, dt
\end{align*}
</div>
<p>For a well-behaved function \(f\) (the precise assumption is that \(f\) is \(C^2\) on \([a,b]\)),the second derivative is bounded on \([a,b]\) - that is, we assume that there exists a constant \(K\) so that \(\abs{f''(x)} \leq K\) for all \(x \in [a,b]\text{.}\) Then, using the triangle inequality, we derive the approximation</p>
<div class="displaymath">
\begin{align*}
\abs{E_T} \amp= \abs{\int_0^{\Delta x} \left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right) \left(\sum_{i = 0}^{n-1} f''(t + x_i)\right)\, dt}\\
\amp \leq \int_0^{\Delta x} \abs{\left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right)} \abs{\left(\sum_{i = 0}^{n-1} f''(t + x_i)\right)}\, dt\\
\amp\leq \int_0^{\Delta x} \abs{\left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right)} \abs{\left(\sum_{i = 0}^{n-1} K \right)}\, dt\\
\amp \leq nK \int_0^{\Delta x} \abs{\left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right)} \, dt 
\end{align*}
</div>
<p>The function \(g(t) =\left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right)\) is a parabola that opens upwards with zeros at \(t = 0\) and \(t = h\text{,}\) and so</p>
<div class="displaymath">
\begin{align*}
\amp \int_0^{\Delta x} \abs{\left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right)} \, dt\\
\amp \int_0^{\Delta x} \frac{(\Delta x)^2}{8} - \left(\frac{(t - \frac{\Delta x}{2})^2}{2} \right) \, dt\\
\amp = \left[\frac{(\Delta x)^2}{8}t - \frac{(t - \frac{\Delta x}{2})^3}{6}\right]_0^{\Delta x} \\
\amp= \frac{(\Delta x)^3}{12}
\end{align*}
</div>
<p>Putting this together with the previous computation, we get</p>
<div class="displaymath">
\begin{equation*}
\abs{E_T} \leq nK\frac{(\Delta x)^3}{12} = nK \frac{(b-a)^3}{12 n^3} = \frac{K(b-a)^3}{12 n^2},
\end{equation*}
</div>
<p>where \(K\) was an absolute bound for \(f''\) on \([a,b]\text{,}\) and in the worst case, we get \(\abs{E_T} \leq \frac{K(b-a)^3}{12} \frac{1}{n^2} = \frac{C}{n^2}\) - that is, the error is proportional to \(\frac{1}{n^2}\text{,}\) which establishes the claim.</p></article><span class="incontext"><a href="section-6.html#proof-1">in-context</a></span>
</body>
</html>
