<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-11-21T15:45:43-05:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>The Elgamal cryptosystem</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.12/pretext.js"></script><script src="https://pretextbook.org/js/0.12/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/toc.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/setcolors.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.12;
</script>
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\DeclareMathOperator{\RE}{Re}
\DeclareMathOperator{\IM}{Im}
\DeclareMathOperator{\ess}{ess}
\DeclareMathOperator{\intr}{int}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator\re{\mathrm {Re~}}
\DeclareMathOperator\im{\mathrm {Im~}}
\newcommand\dd{\mathrm d}
\newcommand{\eps}{\varepsilon}
\newcommand{\To}{\longrightarrow}
\newcommand{\hilbert}{\mathcal{H}}
\newcommand{\s}{\mathcal{S}_2}
\newcommand{\A}{\mathcal{A}}
\newcommand\h{\mathcal{H}}
\newcommand{\J}{\mathcal{J}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathcal{N}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\W}{\mathcal{W}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\D}{\mathbb{D}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\BOP}{\mathbf{B}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\BH}{\mathbf{B}(\mathcal{H})}
\newcommand{\KH}{\mathcal{K}(\mathcal{H})}
\newcommand{\pick}{\mathcal{P}_2}
\newcommand{\schur}{\mathcal{S}_2}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Complex}{\mathbb{C}}
\newcommand{\Field}{\mathbb{F}}
\newcommand{\RPlus}{\Real^{+}}
\newcommand{\Polar}{\mathcal{P}_{\s}}
\newcommand{\Poly}{\mathcal{P}(E)}
\newcommand{\EssD}{\mathcal{D}}
\newcommand{\Lop}{\mathcal{L}}
\newcommand{\cc}[1]{\overline{#1}}
\newcommand{\abs}[1]{\left\vert#1\right\vert}
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\seq}[1]{\left\lt#1\right&gt;}
\newcommand{\norm}[1]{\left\Vert#1\right\Vert}
\newcommand{\essnorm}[1]{\norm{#1}_{\ess}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\ran}[1]{\operatorname{ran}#1}
\newcommand{\nt}{\stackrel{\mathrm {nt}}{\to}}
\newcommand{\pnt}{\xrightarrow{pnt}}
\newcommand{\ip}[2]{\left\langle #1, #2 \right\rangle}
\newcommand{\ad}{^\ast}
\newcommand{\inv}{^{-1}}
\newcommand{\adinv}{^{\ast -1}}
\newcommand{\invad}{^{-1 \ast}}
\newcommand\Pick{\mathcal P}
\newcommand\Ha{\mathbb{H}}
\newcommand{\HH}{\Ha\times\Ha}
\newcommand\Htau{\mathbb{H}(\tau)}
\newcommand{\vp}{\varphi}
\newcommand{\ph}{\varphi}
\newcommand\al{\alpha}
\newcommand\ga{\gamma}
\newcommand\de{\delta}
\newcommand\ep{\varepsilon}
\newcommand\la{\lambda}
\newcommand\up{\upsilon}
\newcommand\si{\sigma}
\newcommand\beq{\begin{equation}}
\newcommand\ds{\displaystyle}
\newcommand\eeq{\end{equation}}
\newcommand\df{\stackrel{\rm def}{=}}
\newcommand\ii{\mathrm i}
\newcommand{\vectwo}[2]
{
   \begin{pmatrix} #1 \\ #2 \end{pmatrix}
}
\newcommand{\vecthree}[3]
{
   \begin{pmatrix} #1 \\ #2 \\ #3 \end{pmatrix}
}
\newcommand\blue{\color{blue}}
\newcommand\black{\color{black}}
\newcommand\red{\color{red}}
\newcommand\nn{\nonumber}
\newcommand\bbm{\begin{bmatrix}}
\newcommand\ebm{\end{bmatrix}}
\newcommand\bpm{\begin{pmatrix}}
\newcommand\epm{\end{pmatrix}}
\numberwithin{equation}{section}
\newcommand\nin{\noindent}
\newcommand{\nCr}[2]{\,_{#1}C_{#2}} 
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="cryptography.html"><span class="title">Mathematical Cryptography</span></a></h1>
<p class="byline">Ryan Tully-Doyle</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="section-dh.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="chapter-groups.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="section-groups.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="section-dh.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="chapter-groups.html" title="Up">Up</a><a class="next-button button toolbar-item" href="section-groups.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link"><a href="frontmatter-1.html" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a></li>
<li class="link">
<a href="chapter-intro.html" data-scroll="chapter-intro"><span class="codenumber">1</span> <span class="title">Preliminaries</span></a><ul>
<li><a href="foreward.html" data-scroll="foreward">The course</a></li>
<li><a href="motivation.html" data-scroll="motivation">Why “mathematical” cryptography?</a></li>
<li><a href="shift.html" data-scroll="shift">A simple example: the shift cipher</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-numbertheory.html" data-scroll="chapter-numbertheory"><span class="codenumber">2</span> <span class="title">Number theory</span></a><ul>
<li><a href="divisibility.html" data-scroll="divisibility">Integers and divisibility</a></li>
<li><a href="section-euclidean.html" data-scroll="section-euclidean">Common divisors and the Euclidean algorithm</a></li>
<li><a href="section-modular.html" data-scroll="section-modular">Modular arithmetic and the ring of integers modulo \(n\)</a></li>
<li><a href="section-fastpower.html" data-scroll="section-fastpower">The fast powering algorithm</a></li>
<li><a href="section-finite-fields.html" data-scroll="section-finite-fields">Finite fields</a></li>
<li><a href="section-fermat.html" data-scroll="section-fermat">Fermat's little theorem and computing inverses</a></li>
<li><a href="section-ch2-conclusion.html" data-scroll="section-ch2-conclusion">Conclusion</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-groups.html" data-scroll="chapter-groups"><span class="codenumber">3</span> <span class="title">Group based methods</span></a><ul>
<li><a href="section-naive.html" data-scroll="section-naive">A naïve cryptosystem and some related questions</a></li>
<li><a href="section-discretelog.html" data-scroll="section-discretelog">Discrete logarithms</a></li>
<li><a href="section-dh.html" data-scroll="section-dh">Diffie-Hellman key exchange</a></li>
<li><a href="section-elgamal.html" data-scroll="section-elgamal" class="active">The Elgamal cryptosystem</a></li>
<li><a href="section-groups.html" data-scroll="section-groups">Groups</a></li>
<li><a href="section-attack-dlp.html" data-scroll="section-attack-dlp">Attacking the discrete log problem</a></li>
<li><a href="section-chinese.html" data-scroll="section-chinese">The Chinese Remainder theorem and Pohlig-Hellman*</a></li>
<li><a href="section-homomorphism.html" data-scroll="section-homomorphism">Homomorphisms and the lunchtime attack</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-elliptic-curves.html" data-scroll="chapter-elliptic-curves"><span class="codenumber">4</span> <span class="title">Elliptic curves and applications</span></a><ul>
<li><a href="section-ec-intro.html" data-scroll="section-ec-intro">Introduction to elliptic curves</a></li>
<li><a href="section-elliptic-addition.html" data-scroll="section-elliptic-addition">Elliptic addition on \(E\text{.}\)</a></li>
<li><a href="section-ec-finite-fields.html" data-scroll="section-ec-finite-fields">Elliptic curves over finite fields</a></li>
<li><a href="section-ecdlp.html" data-scroll="section-ecdlp">Discrete logs and the ECDLP</a></li>
<li><a href="section-ec-elgamal.html" data-scroll="section-ec-elgamal">Elliptic curve Diffie-Hellman key exchange and El Gamal</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-digital-signatures.html" data-scroll="chapter-digital-signatures"><span class="codenumber">5</span> <span class="title">Digital signatures</span></a><ul>
<li><a href="section-dsa-intro.html" data-scroll="section-dsa-intro">Introduction to digital signatures</a></li>
<li><a href="section-elgamal-ds.html" data-scroll="section-elgamal-ds">Elgamal digital signatures</a></li>
<li><a href="section-subgroups.html" data-scroll="section-subgroups">Subgroups and cyclic subgroups</a></li>
<li><a href="section-dsa-ecdsa.html" data-scroll="section-dsa-ecdsa">DSA and Elliptic Curve DSA</a></li>
<li><a href="section-bitcoin.html" data-scroll="section-bitcoin">Bitcoin - an application of ECDSA*</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-probability.html" data-scroll="chapter-probability"><span class="codenumber">6</span> <span class="title">Probability and non-deterministic methods</span></a><ul>
<li><a href="section-counting.html" data-scroll="section-counting">Counting*</a></li>
<li><a href="section-perm-comb.html" data-scroll="section-perm-comb">Permutations and combinations*</a></li>
<li><a href="section-prime-testing.html" data-scroll="section-prime-testing">Primality testing</a></li>
<li><a href="section-pollard-concrete.html" data-scroll="section-pollard-concrete">Pollard's \(\rho\) method</a></li>
</ul>
</li>
<li class="link"><a href="backmatter-1.html" data-scroll="backmatter-1"><span class="title">Back Matter</span></a></li>
<li class="link"><a href="code.html" data-scroll="code"><span class="codenumber">A</span> <span class="title">Code repository</span></a></li>
<li class="link">
<a href="chapter-7.html" data-scroll="chapter-7"><span class="codenumber">7</span> <span class="title">Exercises</span></a><ul>
<li><a href="exercises-21.html" data-scroll="exercises-21">Set 1</a></li>
<li><a href="exercises-22.html" data-scroll="exercises-22">Set 2</a></li>
<li><a href="exercises-23.html" data-scroll="exercises-23">Set 3</a></li>
<li><a href="exercises-24.html" data-scroll="exercises-24">Set 4</a></li>
</ul>
</li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="section-elgamal"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">3.4</span> <span class="title">The Elgamal cryptosystem</span>
</h2>
<a href="section-elgamal.html" class="permalink">¶</a><p id="p-97">In their 1978 paper, Diffie and Hellman proposed a scheme called public key encryption, though they didn't provide an implementation. Two successful schemes that followed immediately from their work are the RSA family of methods (which are based on modular square roots) and the Elgamal family of methods (which are based on modular exponentiation). While RSA came first historically, the Elgamal cryptosystem is directly related to Diffie-Hellman key exchange, and so we are motivated to discuss it first. The Elgamal system is also readily adapted to more complicated setups, like groups on elliptic curves, which will be discussed later in this chapter.</p>
<p id="p-98">An <dfn class="terminology">asymmetric</dfn> or <dfn class="terminology">public key</dfn> system is a one-way encrpytion scheme. That is, Alice provides certain information - the particular algorithm to be used, information about the keyspace and message space, and a public key \(k_{pub}\text{.}\) Bob uses that information to encrypt a message \(m\) as a ciphertext \(c\) that he sends to Alice. Alice then uses a piece of secret information, the private key \(k_{priv}\text{,}\) to decrypt the ciphertext back into the message.</p>
<p id="p-99">The Elgamal system works as follows: Alice chooses a large prime \(p\) and an element \(g\) of large prime order in \(\F_p\ad\text{.}\) She then selects her private key, \(a \in \F_p\ad\text{.}\) She uses her key to compute her public key \(A = g^a\) and publishes \(p, g, A\text{.}\)</p>
<p id="p-100">Bob chooses a plaintext \(m \in \F_p\ad\text{.}\) He generates a <em class="emphasis">one-use only</em> random element \(k \in F_p\ad\) (to emphasize that this is to be used only once, we sometimes refer to it as an <em class="emphasis">ephemeral key</em>), and he computes \(c_1 = g^k\) and \(c_2 = mA^k\text{.}\) He then sends the pair \((c_1, c_2)\) to Alice.</p>
<p id="p-101">To decrypt the message, Alice computes the quantity</p>
<div class="displaymath">
\begin{equation*}
c_2 (c_1^a)\inv = m'.
\end{equation*}
</div>
<p>Then \(m' = m\text{.}\)</p>
<article class="theorem-like" id="alg-elgamal"><h6 class="heading">
<span class="type">Algorithm</span> <span class="codenumber">3.4.1</span>. <span class="title">Elgamal.</span>
</h6>
<ol class="decimal">
<li id="li-74">Alice chooses a large prime \(p\text{,}\) \(g \in F_p\ad\) of large prime order and \(a \in F_p\ad\text{.}\)</li>
<li id="li-75">Alice computes \(A = g^a\text{.}\)</li>
<li id="li-76">Alice publishes \(p, g, A\text{.}\)</li>
<li id="li-77">Bob selects a plaintext \(m\text{.}\) He generates a random element \(k\text{.}\)</li>
<li id="li-78">Bob computes \(c_1 = g^k, c_2 = mA^k\text{.}\)</li>
<li id="li-79">Bob sends \((c_1, c_2)\) to Alice.</li>
<li id="li-80">Alice computes \(c_2 (c_1^a)\inv\text{.}\)</li>
</ol></article><p id="p-102">How do we decide if the Elgamal system is secure? One method of proof is to show that the problem is equivalent in difficulty to the DHP, which we know to be at least as hard as the DLP. To prove this, we will use the concept of an <dfn class="terminology">oracle</dfn>, a thought-experiement black box that we can endow with any particular ability that we choose. For the purpose of the next argument, we will posit the existence of an Elgamal oracle - that is, a function that takes as input \(p, g, A, (c_1, c_2)\) and produces a plaintext \(m\text{.}\) (Notice that the magic of the oracle is in not requiring knowledge of the private key \(a\text{.}\))</p>
<article class="theorem-like" id="proposition-2"><h6 class="heading">
<span class="type">Proposition</span> <span class="codenumber">3.4.2</span>.</h6>\(p, g\text{.}\)</article><article class="hiddenproof" id="proof-3"><a data-knowl="" class="id-ref" data-refid="hk-proof-3"><h6 class="heading"><span class="type">Proof.</span></h6></a></article><div id="hk-proof-3" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><p id="p-103">Suppose that Eve has an Elgamal oracle, and that she wishes to compute the value of \(g^{ab}\) given known values of \(g^a\) and \(g^b\text{.}\) She knows that if she feeds the oracle a ciphertext \((c_1, c_2)\) that the oracle will return the quantity \(c2 (c_1^a)\inv\text{.}\) If Eve feeds the oracle the ciphertext \((g^b, 1)\text{,}\) then the oracle will return the quantity \(1\cdot(g^{ab})\inv.\) The fast inverse computation methods will allow Eve to calculate \(g^{ab}\) with little difficulty.</p>
<p id="p-104">On the other hand, if Eve can solve the DHP, then she can compute \(g^{ak}\) from \(c_1 = g^k\) and \(A = g^a\text{.}\) Then it is straightforward for her to compute \(c_2 \cdot (g^{ak})\inv = m\text{.}\)</p>
<p id="p-105">Thus, breaking Elgamal has equivalent difficulty to solving the DHP.</p></article></div>
<section class="exercises" id="exercises-9"><h3 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber"></span> <span class="title">Exercises</span>
</h3>
<article class="exercise-like" id="exercise-18"><h6 class="heading"><span class="codenumber">1.</span></h6>Prove that \(m' = m\) in the Elgamal cryptosystem.</article><article class="exercise-like" id="exercise-19"><h6 class="heading"><span class="codenumber">2.</span></h6>Implement the Elgamal system in python. You should have an encryption function \(e\) that takes \(g, p, A, m\) and produces a pair \((c_1, c_2)\text{.}\) You should have a decryption function \(d\) that takes as input \(g, p, a, (c_1, c_2)\) and produces a plaintext \(m\text{.}\) The implementation should use your previous implementations of the fast powering algorithm and the inverse finding algorithm.</article></section></section></div></main>
</div>
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.12/login.js"></script>
</body>
</html>
