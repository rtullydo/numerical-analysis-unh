<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-11-22T12:46:28-05:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Numerical Integration</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script>$(function () {
    // Make *any* div with class 'sagecell-sage' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-sage',
                           linked: true,
                           languages: ['sage'],
                           evalButtonText: 'Evaluate (Sage)'});
});
</script><script>$(function () {
    // Make *any* div with class 'sagecell-octave' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-octave',
                           linked: true,
                           languages: ['octave'],
                           evalButtonText: 'Evaluate (Octave)'});
});
</script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.12/pretext.js"></script><script src="https://pretextbook.org/js/0.12/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/toc.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/setcolors.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.12;
</script>
</head>
<body class="mathbook-article has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\DeclareMathOperator{\RE}{Re}
\DeclareMathOperator{\IM}{Im}
\DeclareMathOperator{\ess}{ess}
\DeclareMathOperator{\intr}{int}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator\re{\mathrm {Re~}}
\DeclareMathOperator\im{\mathrm {Im~}}
\newcommand\dd{\mathrm d}
\newcommand{\eps}{\varepsilon}
\newcommand{\To}{\longrightarrow}
\newcommand{\hilbert}{\mathcal{H}}
\newcommand{\s}{\mathcal{S}_2}
\newcommand{\A}{\mathcal{A}}
\newcommand\h{\mathcal{H}}
\newcommand{\J}{\mathcal{J}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathcal{N}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\W}{\mathcal{W}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\D}{\mathbb{D}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\BOP}{\mathbf{B}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\BH}{\mathbf{B}(\mathcal{H})}
\newcommand{\KH}{\mathcal{K}(\mathcal{H})}
\newcommand{\pick}{\mathcal{P}_2}
\newcommand{\schur}{\mathcal{S}_2}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Complex}{\mathbb{C}}
\newcommand{\Field}{\mathbb{F}}
\newcommand{\RPlus}{\Real^{+}}
\newcommand{\Polar}{\mathcal{P}_{\s}}
\newcommand{\Poly}{\mathcal{P}(E)}
\newcommand{\EssD}{\mathcal{D}}
\newcommand{\Lop}{\mathcal{L}}
\newcommand{\cc}[1]{\overline{#1}}
\newcommand{\abs}[1]{\left\vert#1\right\vert}
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\seq}[1]{\left\lt#1\right&gt;}
\newcommand{\norm}[1]{\left\Vert#1\right\Vert}
\newcommand{\essnorm}[1]{\norm{#1}_{\ess}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\ran}[1]{\operatorname{ran}#1}
\newcommand{\nt}{\stackrel{\mathrm {nt}}{\to}}
\newcommand{\pnt}{\xrightarrow{pnt}}
\newcommand{\ip}[2]{\left\langle #1, #2 \right\rangle}
\newcommand{\ad}{^\ast}
\newcommand{\inv}{^{-1}}
\newcommand{\adinv}{^{\ast -1}}
\newcommand{\invad}{^{-1 \ast}}
\newcommand\Pick{\mathcal P}
\newcommand\Ha{\mathbb{H}}
\newcommand{\HH}{\Ha\times\Ha}
\newcommand\Htau{\mathbb{H}(\tau)}
\newcommand{\vp}{\varphi}
\newcommand{\ph}{\varphi}
\newcommand\al{\alpha}
\newcommand\ga{\gamma}
\newcommand\de{\delta}
\newcommand\ep{\varepsilon}
\newcommand\la{\lambda}
\newcommand\up{\upsilon}
\newcommand\si{\sigma}
\newcommand\beq{\begin{equation}}
\newcommand\ds{\displaystyle}
\newcommand\eeq{\end{equation}}
\newcommand\df{\stackrel{\rm def}{=}}
\newcommand\ii{\mathrm i}
\newcommand{\vectwo}[2]
{
   \begin{pmatrix} #1 \\ #2 \end{pmatrix}
}
\newcommand{\vecthree}[3]
{
   \begin{pmatrix} #1 \\ #2 \\ #3 \end{pmatrix}
}
\newcommand\blue{\color{blue}}
\newcommand\black{\color{black}}
\newcommand\red{\color{red}}
\newcommand\nn{\nonumber}
\newcommand\bbm{\begin{bmatrix}}
\newcommand\ebm{\end{bmatrix}}
\newcommand\bpm{\begin{pmatrix}}
\newcommand\epm{\end{pmatrix}}
\numberwithin{equation}{section}
\newcommand\nin{\noindent}
\newcommand{\nCr}[2]{\,_{#1}C_{#2}} 
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="minimal.html"><span class="title">Numerical Analysis</span></a></h1>
<p class="byline">Ryan Tully-Doyle</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="section-5.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="minimal.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="section-7.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="section-5.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="minimal.html" title="Up">Up</a><a class="next-button button toolbar-item" href="section-7.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link"><a href="frontmatter-1.html" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a></li>
<li class="link"><a href="section-needs.html" data-scroll="section-needs"><span class="codenumber">1</span> <span class="title">What you need - Octave/Matlab</span></a></li>
<li class="link"><a href="section-review.html" data-scroll="section-review"><span class="codenumber">2</span> <span class="title">Motivation</span></a></li>
<li class="link">
<a href="sec-taylor.html" data-scroll="sec-taylor"><span class="codenumber">3</span> <span class="title">Taylor polynomials</span></a><ul>
<li><a href="sec-taylor.html#subsection-1" data-scroll="subsection-1">Taylor's theorem</a></li>
<li><a href="sec-taylor.html#subsection-2" data-scroll="subsection-2">What is a Taylor approximation good for?</a></li>
<li><a href="sec-taylor.html#subsection-3" data-scroll="subsection-3">Coding functions in Octave</a></li>
</ul>
</li>
<li class="link">
<a href="sec-root.html" data-scroll="sec-root"><span class="codenumber">4</span> <span class="title">Root finding</span></a><ul>
<li><a href="sec-root.html#sub-bisection" data-scroll="sub-bisection">Bisection method</a></li>
<li><a href="sec-root.html#subsection-5" data-scroll="subsection-5">Error</a></li>
<li><a href="sec-root.html#subsection-6" data-scroll="subsection-6">Bisection algorithm</a></li>
<li><a href="sec-root.html#subsection-7" data-scroll="subsection-7">False position (Regula Falsi)</a></li>
<li><a href="sec-root.html#subsection-8" data-scroll="subsection-8">Classes of differentiability</a></li>
<li><a href="sec-root.html#subsection-9" data-scroll="subsection-9">Newton-Raphson method</a></li>
<li><a href="sec-root.html#subsection-10" data-scroll="subsection-10">Newton's method requirements and problems</a></li>
</ul>
</li>
<li class="link">
<a href="section-5.html" data-scroll="section-5"><span class="codenumber">5</span> <span class="title">Interpolation</span></a><ul>
<li><a href="section-5.html#subsection-11" data-scroll="subsection-11">Naive polynomial interpolation</a></li>
<li><a href="section-5.html#subsection-12" data-scroll="subsection-12">Lagrange interpolation</a></li>
<li><a href="section-5.html#subsection-13" data-scroll="subsection-13">Newton interpolation</a></li>
<li><a href="section-5.html#subsection-14" data-scroll="subsection-14">Problems with polynomials</a></li>
<li><a href="section-5.html#subsection-15" data-scroll="subsection-15">Spline interpolation</a></li>
<li><a href="section-5.html#subsection-16" data-scroll="subsection-16">Many-point spline interpolation example</a></li>
</ul>
</li>
<li class="link active">
<a href="section-6.html" data-scroll="section-6"><span class="codenumber">6</span> <span class="title">Numerical Integration</span></a><ul>
<li><a href="section-6.html#subsection-17" data-scroll="subsection-17">Integration review</a></li>
<li><a href="section-6.html#subsection-18" data-scroll="subsection-18">The trapezoid rule</a></li>
<li><a href="section-6.html#subsection-19" data-scroll="subsection-19">A special case of Richardson's extrapolation (optional)</a></li>
<li><a href="section-6.html#subsection-20" data-scroll="subsection-20">Simpson's 1/3 rule</a></li>
</ul>
</li>
<li class="link">
<a href="section-7.html" data-scroll="section-7"><span class="codenumber">7</span> <span class="title">Introduction to Fourier Series (a linear algebra perspective)</span></a><ul>
<li><a href="section-7.html#subsection-21" data-scroll="subsection-21">Review of linear algebra</a></li>
<li><a href="section-7.html#subsection-22" data-scroll="subsection-22">The space \(L^2[-\pi,\pi]\)</a></li>
<li><a href="section-7.html#subsection-23" data-scroll="subsection-23">Example computation</a></li>
</ul>
</li>
<li class="link">
<a href="section-8.html" data-scroll="section-8"><span class="codenumber">8</span> <span class="title">Code examples</span></a><ul><li><a href="section-8.html#subsection-24" data-scroll="subsection-24">Lab 1 - Introduction</a></li></ul>
</li>
<li class="link">
<a href="section-9.html" data-scroll="section-9"><span class="codenumber">9</span> <span class="title">Assignments</span></a><ul>
<li><a href="section-9.html#subsection-25" data-scroll="subsection-25">Assignment Set 1</a></li>
<li><a href="section-9.html#subsection-26" data-scroll="subsection-26">Assignment Set 2</a></li>
<li><a href="section-9.html#subsection-27" data-scroll="subsection-27">Assignment set 3</a></li>
<li><a href="section-9.html#subsection-28" data-scroll="subsection-28">Assignment set 4</a></li>
<li><a href="section-9.html#subsection-29" data-scroll="subsection-29">Assignment set 5 (including challenge set)</a></li>
<li><a href="section-9.html#subsection-30" data-scroll="subsection-30">Assignment set 6 - Newton polynomials</a></li>
<li><a href="section-9.html#subsection-31" data-scroll="subsection-31">Assignment set 7 - Cubic splines</a></li>
<li><a href="section-9.html#subsection-32" data-scroll="subsection-32">Assignment 8 - Numerical integration</a></li>
</ul>
</li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="section-6"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">6</span> <span class="title">Numerical Integration</span>
</h2>
<section class="subsection" id="subsection-17"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">6.1</span> <span class="title">Integration review</span>
</h3>
<p id="p-116">Before we begin looking at numerical calculus, it is useful to recall some of the basic notions. In particular, we'll be reexamining the introduction to calculus most students see in the second semester of the course.</p>
<p id="p-117">Here is a question - what is \(\int_0^1 x^2 \, dx\text{?}\) Most people that have some experience with calculus will perform the following operation:</p>
<div class="displaymath">
\begin{equation*}
\int_0^1 x^2 \, dx = \frac{1}{3} x^3 |_0^1 = \frac{1}{3}.
\end{equation*}
</div>
<p>However, this computation both misses the point of what the integral represents and uses a technique that will largely be unavailable in practice.</p>
<p id="p-118">As to the first point, the <dfn class="terminology">definite integral</dfn> represents a measurement of the <dfn class="terminology">signed area</dfn> between a graph and the \(x\)-axis. We say signed area because area above the axis and area below the axis are considered to have opposite signs. Again, a definite integral is an area. Below, we plot the region corresponding to \(\int_0^1 x^2 \, dx\text{.}\)</p>
<div class="sagecell-octave" id="sage-40"><script type="text/x-sage">X = 0:.01:1;
X1 = -1:.01:2;
Y = X.^2;
Y1 = X1.^2;
area(X, Y, 'FaceColor', "red")
hold on
plot(X1, Y1)
</script></div>
<p id="p-119">Now, the area of this region is certainly \(\frac{1}{3}\text{.}\) To arrive at that conclusion, we used one of the most important theorems of continuous mathematics, the <dfn class="terminology">fundamental theorem of calculus</dfn>, which gives a connection between definite integrals, that is the signed area under a curve, with indefinite integrals, that is antiderivatives.</p>
<article class="theorem-like" id="theorem-5"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">6.1</span>. <span class="title">Fundamental theorem of calculus, part II.</span>
</h6>
<p id="p-120">Suppose that \(f\) is a function on an interval \([a,b]\) with an antiderivative \(F\) such that \(F'(x) = f(x)\) for all \(x \in [a,b]\text{.}\) If \(f\) is Riemann integrable, then</p>
<div class="displaymath">
\begin{equation*}
\int_a^b f(x)\,dx = F(b) - F(a).
\end{equation*}
</div></article><p id="p-121">One salient assumption present in the fundamental theorem of calculus is the existence of an antiderivative. Unfortunately, there are many functions that do not possess a (closed form) antiderivative, including some of the most useful functions in practice. For example, the <dfn class="terminology">normal distribution</dfn> from statistics is essentially defined by the function \(f(x) = e^{-x^2}\text{.}\) A typical problem might wish to compute an integral like \(\int_{-1}^{2} e^{-x^2} \, dx\text{,}\) which is a simple area contained under a very nice curve, as shown below.</p>
<div class="sagecell-octave" id="sage-41"><script type="text/x-sage">X = -4:.01:4;
XX = -1:.01:2;
plot(X, exp(-X.^2))
hold on
area(XX, exp(-XX.^2))
</script></div>
<p id="p-122">However, the fundamental theorem cannot be used to compute the area indicated by the definite integral because the function \(e^{-x^2}\) has no closed form antiderivative. So we need to approach the area finding problem with techniques related to the definition of definite integrals, which consist of breaking the area under functions up into approximating rectangles and then making the rectangles uniformly smaller in width.</p>
<div class="sagecell-octave" id="sage-42"><script type="text/x-sage">X = 0:.01:1;
Y = X.^2;
rectangle("Position", [0,0, .5, .25], "facecolor","red", "facealpha",.1)
hold on
rectangle("Position", [.5,0, .5, 1], "facecolor","red", "facealpha",.1)
plot(X,Y)
area(X, Y, "facecolor", [0 0.6 .9])
plot(.5*ones(11,1), 0:.1:1, "k")
</script></div>
<p id="p-123">The <dfn class="terminology">Riemann sum</dfn> that approximates the signed area under \(f\) on \([a,b]\) is given by the following formula. Let \(n\) be the number of approximating rectangles, and the width of each rectangle be \(\Delta x = \frac{b - a}{n}.\) Then we can define a partition of \([a,b]\) by \(x_0 = a\text{,}\) \(x_i = x_0 + i \Delta x\text{,}\) and \(x_n = b\text{.}\) On each subinterval \([x_i, x_{i+1}]\text{,}\) we choose a point \(x_i^*\text{.}\) Then the area under \(f\) can be approximated by the expression</p>
<div class="displaymath">
\begin{equation*}
\int_a^b f(x) \, dx \approx \sum_{i = 0}^{n-1} f(x_i^*) \Delta x.
\end{equation*}
</div>
<p>Those functions for which \(\lim_{n \to \infty} \sum_{i = 0}^{n-1} f(x_i^*) \Delta x\) converges are called <dfn class="terminology">Riemann integrable</dfn>.</p>
<p id="p-124">Note, it need not be the case that the rectangles have equal width, which is an assumption made here to simplify the presentation.</p></section><section class="subsection" id="subsection-18"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">6.2</span> <span class="title">The trapezoid rule</span>
</h3>
<p id="p-125">An immediate observation of a Riemann sum approximation for a definite integral might lead you to conclude that other shapes might provide more accurate approximations than rectangles. An easy shape to work with in this context is the trapezoid - it has a simple formula for area and allows us to avoid having to choose random points inside the subintervals. Compare the following pictures.</p>
<div class="sagecell-octave" id="sage-43"><script type="text/x-sage">f = @(x) x.^2;
X = 0:.01:6;
Xi = linspace(0,6,4);
Y = X.^2;
for i = 1:(length(Xi)-1)
    rectangle("Position", [Xi(i),0, Xi(i+1) - Xi(i), f(Xi(i+1))], "facecolor",[0, .8, .8])
endfor
hold on
area(X,Y, "facecolor", [0, .6, .9])
for i = 1:length(Xi)
    plot([Xi(i), Xi(i)], [0, f(Xi(i))], 'k')
endfor
</script></div>
<div class="sagecell-octave" id="sage-44"><script type="text/x-sage">f = @(x) x.^2
X = 0:.01:6;
Xi = linspace(0,6,4);
Y = f(X);
Yi = interp1(X, Y, Xi);
plot(X,Y)
hold on
area(Xi, Yi, "facecolor", [0 .8 .8])
area(X,Y, "facecolor", [0, .6, .9])
for i = 1:length(Xi)
    plot([Xi(i), Xi(i)], [0, f(Xi(i))], 'k')
endfor
</script></div>
<p id="p-126">While the example might seem to be artificially chosen to make the trapezoids significantly more accurate than the rectangles, in fact, the vast majority of graphs of interest will look like the pictures above for small enough subintervals. This motivates the development of the <dfn class="terminology">trapezoid rule</dfn> for approximating a definite integral.</p>
<p id="p-127">Recall that the area of a trapezoid with height \(h\) and base widths \(b_1, b_2\) is given by the formula</p>
<div class="displaymath">
\begin{equation*}
A = \frac{b_1 + b_2}{2} h.
\end{equation*}
</div>
<p>Suppose that \(f\) is a function defined on the interval \(I = [a,b]\) and let \(x_0, \ldots, x_n\) be a uniform partition of \(I\) with subinterval width \(\Delta x = \frac{b -a}{n}\text{.}\) Consider the subinterval \([x_i, x_{i+1}]\text{.}\)  Then</p>
<div class="displaymath">
\begin{equation*}
\int_{x_i}^{x_{i+1}} f(x) \, dx \approx \frac{f(x_i) + f(x_{i+1})}{2} \Delta x.
\end{equation*}
</div>
<p>Thus,</p>
<div class="displaymath">
\begin{align*}
\int_a^b f(x)\, dx \amp = \sum_i \int_{x_i}^{x_{i+1}} f(x) \, dx \\
\amp\approx \sum_i \frac{f(x_i) + f(x_{i+1})}{2} \Delta x \\
\amp = \frac{\Delta x}{2} \left( f(x_0) + 2\sum_{i = 2}^{n-1} f(x_i) + f(x_n)\right)\\
\amp = \frac{b - a}{2n}\left( f(x_0) + 2\sum_{i = 2}^{n-1} f(x_i) + f(x_n)\right)
\end{align*}
</div>
<p>and we define the \(n\) segement trapezoid approximation to the area under \(f\) by</p>
<div class="displaymath">
\begin{equation*}
T_n(f, [a,b]) = \frac{b - a}{2n}\left( f(x_0) + 2\sum_{i = 2}^{n-1} f(x_i) + f(x_n)\right).
\end{equation*}
</div>
<p id="p-128">Let's use the trapezoid rule to approximate the integral indicated above - \(\int_0^6 x^2 \, dx\text{.}\) We'll use three trapezoids as in the example picture. <div class="sagecell-octave" id="sage-45"><script type="text/x-sage">a = 0;
b = 6;
n = 3;
X = linspace(a,b,n+1);
f = @(x) x.^2;
Y = f(X);
approxArea = ((b-a)/(2*n))*(Y(1) + 2*Y(2) + 2*Y(3) + Y(4))
F = @(x) 1/3*x.^3;
trueArea = F(b) - F(a)
error = (approxArea - trueArea) / trueArea
</script></div> We have included the true result, since we can use the fundamental theorem in this case. The result of the approximation with just 3 trapezoids is a relative error of just 5 percent.</p></section><section class="subsection" id="subsection-19"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">6.3</span> <span class="title">A special case of Richardson's extrapolation (optional)</span>
</h3>
<p id="p-129">This section will have a different flavor than most of the rest of the notes. Here, we'll see the “analysis” part of numerical analysis - that is, we're going to use theoretical ideas and estimates to improve the approximation given in the trapezoid formula. The idea is that the application of mathematical reasoning can lead to significant improvements in our naive formulations (a theme common in approximation theory).</p>
<p id="p-130">We'll first recall the <dfn class="terminology">triangle inequality</dfn>, which says that \(\abs{a + b} \leq \abs{a} + \abs{b}\text{.}\) In fact, we can apply this to a sum of any finite length, by induction:</p>
<div class="displaymath">
\begin{equation*}
\abs{\sum_i a_i} \leq \sum_i \abs{a_i}.
\end{equation*}
</div>
<p>Now, Riemann sums are finite sums, and so the triangle inequality applies.</p>
<div class="displaymath">
\begin{equation*}
\abs{\sum_{i = 0}^{n-1} f(x_i^*) \Delta x} \leq \sum_{i = 0}^{n-1} \abs{f(x_i^*)} \Delta x,
\end{equation*}
</div>
<p>and when the limit of the Riemann sum exists as the number of rectangles tends to infinity (that is, whenever \(f\) is Riemann integrable), we get the integral version of the triangle inequality:</p>
<div class="displaymath">
\begin{equation*}
\abs{\int_a^b f(x) \, dx} \leq \int_a^b \abs{f(x)} \, dx.
\end{equation*}
</div>
<p>This is a theorem in real analysis and will be used here without a formal proof beyond the sketch above.</p>
<p id="p-131">Let \(I = \int_a^b f(x) \, dx\text{.}\) Let \(T_n\) represent the \(n\) segment trapezoid approximation of \(I\text{.}\) Let \(E_T\) be the error in the approximation - that is</p>
<div class="displaymath">
\begin{equation*}
E_T = I - T_n.
\end{equation*}
</div>
<p>Our first goal is to measure how large the error \(E_T\) is expected to be in terms of the number of trapezoids \(n\text{.}\)</p>
<article class="theorem-like" id="theorem-6"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">6.2</span>.</h6>
<p id="p-132">Let \(f\) be Riemann integrable on \([a,b]\text{.}\) Then</p>
<div class="displaymath">
\begin{equation*}
\abs{E_T} \sim \frac{1}{n^2}.
\end{equation*}
</div></article><article class="hiddenproof" id="proof-1"><a data-knowl="" class="id-ref" data-refid="hk-proof-1"><h6 class="heading"><span class="type">Proof.</span></h6></a></article><div id="hk-proof-1" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><p id="p-133">Let \(\Delta x = x_{i+1} - x_i = \frac{b -a}{n}\text{.}\) We first analyze the error in the trapezoid approximation on a single interval. A \(u\)-substitution gives</p>
<div class="displaymath">
\begin{equation*}
\int_{x_i}^{x_{i+1}} f(x) \, dx = \int_0^{\Delta x} f(t + x_i) \, dt.
\end{equation*}
</div>
<p>Using integration by parts twice, we get <figure class="figure-like" id="table-1"><table>
<tr>
<td class="l m b2 r2 l0 t0 lines">\(u\)</td>
<td class="l m b2 r0 l0 t0 lines">\(v\)</td>
</tr>
<tr>
<td class="l m b0 r2 l0 t0 lines">\(f(t + x_i)\)</td>
<td class="l m b0 r0 l0 t0 lines">\(1\)</td>
</tr>
<tr>
<td class="l m b0 r2 l0 t0 lines">\(f'(t + x_i)\)</td>
<td class="l m b0 r0 l0 t0 lines">\(t + A\)</td>
</tr>
<tr>
<td class="l m b0 r2 l0 t0 lines">\(f''(t + x_i)\)</td>
<td class="l m b0 r0 l0 t0 lines">\(\frac{(t + A)^2}{2} + B\)</td>
</tr>
</table>
<figcaption><span class="type">Table</span> <span class="codenumber">6.3.</span> </figcaption></figure> where we forgo the usual choice of 0 as the integration constant (hence the \(A, B\) in the table), which gives the formula</p>
<div class="displaymath">
\begin{align*}
\amp\int_0^{\Delta x} f(t + x_i)\, dx \\
\amp = \left[(t+A)f(t+x_i)\right]_0^{\Delta x} \\
\amp - \left[\left(\frac{(t + A)^2}{2} + B\right)f'(t + x_i)\right]_0^{\Delta x}\\
\amp+ \int_0^{\Delta x} \left(\frac{(t + A)^2}{2} + B\right) f''(t + x_i)\, dx.
\end{align*}
</div>
<p id="p-134">From this point, the idea is to choose values of \(A, B\) that force each term to play a certain role, with the goal of concentrating the error of the approximation in the integral term. First, we choose \(A\) so that the first term above is equal to the trapezoid area - that is, we want</p>
<div class="displaymath">
\begin{equation*}
(\Delta x + A) f(\Delta x + x_i) - Af(x_i) = \frac{f(x_{i+1}) + f(x_i)}{2} \Delta x.
\end{equation*}
</div>
<p>Algebra shows that \(A = \frac{-\Delta x}{2}\) solves the equation.</p>
<p id="p-135">Now, we want to choose \(B\) so that the second term is zero. That is, we want</p>
<div class="displaymath">
\begin{align*}
\amp \left[\left(\frac{(t + A)^2}{2} + B\right)f'(t + x_i)\right]_0^{\Delta x} \\
\amp = \left(\frac{(\Delta x)^2}{8} + B\right)\left[f'(x_{i+1}) - f'(x_i)\right]= 0.
\end{align*}
</div>
<p>This obviously holds when \(B = \frac{-(\Delta x)^2}{8}\text{.}\)</p>
<p id="p-136">We conclude that the error on the \(i\)th segment, denoted \(E_T(i)\) is given by</p>
<div class="displaymath">
\begin{equation*}
E_T(i) = \int_0^{\Delta x} \left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right) f''(t + x_i) \, dt
\end{equation*}
</div>
<p id="p-137">Now, we can get the total error in the trapezoid approximation by adding each of the individual errors.</p>
<div class="displaymath">
\begin{align*}
E_T \amp= \sum E_T(i)\\
\amp = \sum_{i=0}^{n-1} \int_0^{\Delta x} \left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right) f''(t + x_i) \, dt \\
\amp =\int_0^{\Delta x} \left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right) \left(\sum_{i = 0}^{n-1} f''(t + x_i)\right) \, dt
\end{align*}
</div>
<p id="p-138">For a well-behaved function \(f\) (the precise assumption is that \(f\) is \(C^2\) on \([a,b]\)),the second derivative is bounded on \([a,b]\) - that is, we assume that there exists a constant \(K\) so that \(\abs{f''(x)} \leq K\) for all \(x \in [a,b]\text{.}\) Then, using the triangle inequality, we derive the approximation</p>
<div class="displaymath">
\begin{align*}
\abs{E_T} \amp= \abs{\int_0^{\Delta x} \left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right) \left(\sum_{i = 0}^{n-1} f''(t + x_i)\right)\, dt}\\
\amp \leq \int_0^{\Delta x} \abs{\left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right)} \abs{\left(\sum_{i = 0}^{n-1} f''(t + x_i)\right)}\, dt\\
\amp\leq \int_0^{\Delta x} \abs{\left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right)} \abs{\left(\sum_{i = 0}^{n-1} K \right)}\, dt\\
\amp \leq nK \int_0^{\Delta x} \abs{\left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right)} \, dt 
\end{align*}
</div>
<p id="p-139">The function \(g(t) =\left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right)\) is a parabola that opens upwards with zeros at \(t = 0\) and \(t = h\text{,}\) and so</p>
<div class="displaymath">
\begin{align*}
\amp \int_0^{\Delta x} \abs{\left(\frac{(t - \frac{\Delta x}{2})^2}{2} - \frac{(\Delta x)^2}{8}\right)} \, dt\\
\amp \int_0^{\Delta x} \frac{(\Delta x)^2}{8} - \left(\frac{(t - \frac{\Delta x}{2})^2}{2} \right) \, dt\\
\amp = \left[\frac{(\Delta x)^2}{8}t - \frac{(t - \frac{\Delta x}{2})^3}{6}\right]_0^{\Delta x} \\
\amp= \frac{(\Delta x)^3}{12}
\end{align*}
</div>
<p id="p-140">Putting this together with the previous computation, we get</p>
<div class="displaymath">
\begin{equation*}
\abs{E_T} \leq nK\frac{(\Delta x)^3}{12} = nK \frac{(b-a)^3}{12 n^3} = \frac{K(b-a)^3}{12 n^2},
\end{equation*}
</div>
<p>where \(K\) was an absolute bound for \(f''\) on \([a,b]\text{,}\) and in the worst case, we get \(\abs{E_T} \leq \frac{K(b-a)^3}{12} \frac{1}{n^2} = \frac{C}{n^2}\) - that is, the error is proportional to \(\frac{1}{n^2}\text{,}\) which establishes the claim.</p></article></div>
<p id="p-141">Under the assumption of worst case error and a reasonable function \(f\text{,}\) we conclude that the total trapezoidal error \(E_T\) is proportional to \(\frac{1}{n^2}\text{,}\) or in other words that</p>
<div class="displaymath">
\begin{equation*}
E_T = \frac{C}{n^2}.
\end{equation*}
</div>
<p>So how can we use this to build a better process? Note that for \(n\) segments, we can write</p>
<div class="displaymath">
\begin{equation*}
I = T_n + \frac{C}{n^2}
\end{equation*}
</div>
<p>and likewise for \(2n\) segments, we have</p>
<div class="displaymath">
\begin{equation*}
I = T_{2n} + \frac{C}{(2n)^2},
\end{equation*}
</div>
<p>which is a system of simultaneous equations. We'll prepare to eliminate \(C\text{.}\)</p>
<div class="displaymath">
\begin{align*}
I \amp = T_{n} + \frac{C}{n^2}\\
I \amp = T_{2n} + \frac{C}{4n^2}\\
\amp\\
n^2 I \amp = n^2 T_n + C \\
4n^2 I \amp= 4n^2 T_{2n} + C \\
\amp \\
3n^2 I \amp = 4n^2 T_{2n} - n^2 T_n\\
\amp \\
I \amp = T_{2n} + \frac{T_{2n} - T_n}{3}
\end{align*}
</div>
<p id="p-142">Thus, we have what is known as a first order Richardson's extrapolation -</p>
<div class="displaymath">
\begin{equation*}
\int_a^b f(x) \, dx \approx T_{2n} + \frac{T_{2n} - T_n}{3}.
\end{equation*}
</div>
<p>Let's see how it performs with our existing example.</p>
<div class="sagecell-octave" id="sage-46"><script type="text/x-sage">a = 0;
b = 6;
n = 3;
X = linspace(a,b,n+1);
f = @(x) x.^2;
Y = f(X);
T3 = ((b-a)/(2*n))*(Y(1) + 2*Y(2) + 2*Y(3) + Y(4))
m = 6;
XX = linspace(a, b, m+1);
YY = f(XX);
T6 = ((b-a)/(2*m))*(YY(1) + 2*(YY(2)+ YY(3) + YY(4) + YY(5) + YY(6)) + YY(7));
R6 = T6 + (T6 - T3)/(3)
F = @(x) 1/3*x.^3;
trueArea = F(b) - F(a)
errorT = (T6 - trueArea) / trueArea
errorR = (R6 - trueArea) / trueArea
</script></div></section><section class="subsection" id="subsection-20"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">6.4</span> <span class="title">Simpson's 1/3 rule</span>
</h3>
<p id="p-143">An alternative to using trapezoids is to use polynomials to interpolate sample points. It turns out that using quadratic polynomials on equally spaced interpolation points gives a very nice formula. We'll begin with a single segment and approximate \(\int_a^b f(x)\, dx\text{.}\)</p>
<p id="p-144">Recall that there is a unique parabola through any three points - we'll use the points \((a, f(a)), ((a+b)/2, f((a+b)/2), (b, f(b))\text{.}\) We have several techniques available for finding such an interpolation - we'll derive ours using Newton polynomials. The Newton polynomial through our points is</p>
<div class="displaymath">
\begin{equation*}
f(x) = b_0 + b_1 (x - a) + b_2 (x -a) (x - (\frac{a+b}{2})),
\end{equation*}
</div>
<p>where</p>
<div class="displaymath">
\begin{equation*}
b_0 = a, b_1 = \frac{f((a+b)/2) - f(a)}{(a + b)/2 - a}, b_2 = \frac{\frac{f(b) - f((a+b)/2)}{b - (a+b)/2} - \frac{f((a+b)/2) - f(a)}{(a+b)/2 - a}}{b - a}
\end{equation*}
</div></section></section></div></main>
</div>
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.12/login.js"></script>
</body>
</html>
